function createNotImplementedError(e){throw new Error(`[unenv] ${e} is not implemented yet!`)}function notImplemented(e){return Object.assign((()=>{throw createNotImplementedError(e)}),{__unenv__:!0})}const e=[],t=[],r="undefined"==typeof Uint8Array?Array:Uint8Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let r=0,s=64;r<s;++r)e[r]=n[r],t[n.charCodeAt(r)]=r;function toByteArray(e){let n;const s=function(e){const t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");let r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}(e),i=s[0],o=s[1],a=new r(function(e,t,r){return 3*(t+r)/4-r}(0,i,o));let l=0;const u=o>0?i-4:i;let c;for(c=0;c<u;c+=4)n=t[e.charCodeAt(c)]<<18|t[e.charCodeAt(c+1)]<<12|t[e.charCodeAt(c+2)]<<6|t[e.charCodeAt(c+3)],a[l++]=n>>16&255,a[l++]=n>>8&255,a[l++]=255&n;return 2===o&&(n=t[e.charCodeAt(c)]<<2|t[e.charCodeAt(c+1)]>>4,a[l++]=255&n),1===o&&(n=t[e.charCodeAt(c)]<<10|t[e.charCodeAt(c+1)]<<4|t[e.charCodeAt(c+2)]>>2,a[l++]=n>>8&255,a[l++]=255&n),a}function encodeChunk(t,r,n){let s;const i=[];for(let a=r;a<n;a+=3)s=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),i.push(e[(o=s)>>18&63]+e[o>>12&63]+e[o>>6&63]+e[63&o]);var o;return i.join("")}function fromByteArray(t){let r;const n=t.length,s=n%3,i=[],o=16383;for(let e=0,r=n-s;e<r;e+=o)i.push(encodeChunk(t,e,e+o>r?r:e+o));return 1===s?(r=t[n-1],i.push(e[r>>2]+e[r<<4&63]+"==")):2===s&&(r=(t[n-2]<<8)+t[n-1],i.push(e[r>>10]+e[r>>4&63]+e[r<<2&63]+"=")),i.join("")}function read(e,t,r,n,s){let i,o;const a=8*s-n-1,l=(1<<a)-1,u=l>>1;let c=-7,f=r?s-1:0;const h=r?-1:1;let d=e[t+f];for(f+=h,i=d&(1<<-c)-1,d>>=-c,c+=a;c>0;)i=256*i+e[t+f],f+=h,c-=8;for(o=i&(1<<-c)-1,i>>=-c,c+=n;c>0;)o=256*o+e[t+f],f+=h,c-=8;if(0===i)i=1-u;else{if(i===l)return o?Number.NaN:(d?-1:1)*Number.POSITIVE_INFINITY;o+=Math.pow(2,n),i-=u}return(d?-1:1)*o*Math.pow(2,i-n)}function write(e,t,r,n,s,i){let o,a,l,u=8*i-s-1;const c=(1<<u)-1,f=c>>1,h=23===s?Math.pow(2,-24)-Math.pow(2,-77):0;let d=n?0:i-1;const p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),Number.isNaN(t)||t===Number.POSITIVE_INFINITY?(a=Number.isNaN(t)?1:0,o=c):(o=Math.floor(Math.log2(t)),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+f>=1?h/l:h*Math.pow(2,1-f))*l>=2&&(o++,l/=2),o+f>=c?(a=0,o=c):o+f>=1?(a=(t*l-1)*Math.pow(2,s),o+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,s),o=0));s>=8;)e[r+d]=255&a,d+=p,a/=256,s-=8;for(o=o<<s|a,u+=s;u>0;)e[r+d]=255&o,d+=p,o/=256,u-=8;e[r+d-p]|=128*m}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;const s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,i=2147483647;function createBuffer(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,Buffer$1.prototype),t}function Buffer$1(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(e)}return from(e,t,r)}function from(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!Buffer$1.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|byteLength(e,t);let n=createBuffer(r);const s=n.write(e,t);s!==r&&(n=n.slice(0,s));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(isInstance(e,Uint8Array)){const t=new Uint8Array(e);return fromArrayBuffer(t.buffer,t.byteOffset,t.byteLength)}return fromArrayLike(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(isInstance(e,ArrayBuffer)||e&&isInstance(e.buffer,ArrayBuffer))return fromArrayBuffer(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(isInstance(e,SharedArrayBuffer)||e&&isInstance(e.buffer,SharedArrayBuffer)))return fromArrayBuffer(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return Buffer$1.from(n,t,r);const s=function(e){if(Buffer$1.isBuffer(e)){const t=0|checked(e.length),r=createBuffer(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||numberIsNaN(e.length)?createBuffer(0):fromArrayLike(e);if("Buffer"===e.type&&Array.isArray(e.data))return fromArrayLike(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return Buffer$1.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function allocUnsafe(e){return assertSize(e),createBuffer(e<0?0:0|checked(e))}function fromArrayLike(e){const t=e.length<0?0:0|checked(e.length),r=createBuffer(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function fromArrayBuffer(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,Buffer$1.prototype),n}function checked(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function byteLength(e,t){if(Buffer$1.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||isInstance(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(s)return n?-1:utf8ToBytes(e).length;t=(""+t).toLowerCase(),s=!0}}function slowToString(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function swap(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function bidirectionalIndexOf(e,t,r,n,s){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),numberIsNaN(r=+r)&&(r=s?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(s)return-1;r=e.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof t&&(t=Buffer$1.from(t,n)),Buffer$1.isBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,n,s);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,n,s);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,n,s){let i,o=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,r/=2}function read(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let n=-1;for(i=r;i<a;i++)if(read(e,i)===read(t,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===l)return n*o}else-1!==n&&(i-=i-n),n=-1}else for(r+l>a&&(r=a-l),i=r;i>=0;i--){let r=!0;for(let n=0;n<l;n++)if(read(e,i+n)!==read(t,n)){r=!1;break}if(r)return i}return-1}function hexWrite(e,t,r,n){r=Number(r)||0;const s=e.length-r;n?(n=Number(n))>s&&(n=s):n=s;const i=t.length;let o;for(n>i/2&&(n=i/2),o=0;o<n;++o){const n=Number.parseInt(t.slice(2*o,2*o+2),16);if(numberIsNaN(n))return o;e[r+o]=n}return o}function utf8Write(e,t,r,n){return blitBuffer(utf8ToBytes(t,e.length-r),e,r,n)}function asciiWrite(e,t,r,n){return blitBuffer(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function base64Write(e,t,r,n){return blitBuffer(base64ToBytes(t),e,r,n)}function ucs2Write(e,t,r,n){return blitBuffer(function(e,t){let r,n,s;const i=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,s=r%256,i.push(s,n);return i}(t,e.length-r),e,r,n)}function base64Slice(e,t,r){return 0===t&&r===e.length?fromByteArray(e):fromByteArray(e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);const n=[];let s=t;for(;s<r;){const t=e[s];let i=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=r){let r,n,a,l;switch(o){case 1:t<128&&(i=t);break;case 2:r=e[s+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(i=l));break;case 3:r=e[s+1],n=e[s+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(i=l));break;case 4:r=e[s+1],n=e[s+2],a=e[s+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,l>65535&&l<1114112&&(i=l))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),s+=o}return function(e){const t=e.length;if(t<=o)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=o));return r}(n)}Buffer$1.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch{return!1}}(),Buffer$1.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This environment lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer$1.prototype,"parent",{enumerable:!0,get:function(){if(Buffer$1.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer$1.prototype,"offset",{enumerable:!0,get:function(){if(Buffer$1.isBuffer(this))return this.byteOffset}}),Buffer$1.poolSize=8192,Buffer$1.from=function(e,t,r){return from(e,t,r)},Object.setPrototypeOf(Buffer$1.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer$1,Uint8Array),Buffer$1.alloc=function(e,t,r){return function(e,t,r){return assertSize(e),e<=0?createBuffer(e):void 0!==t?"string"==typeof r?createBuffer(e).fill(t,r):createBuffer(e).fill(t):createBuffer(e)}(e,t,r)},Buffer$1.allocUnsafe=function(e){return allocUnsafe(e)},Buffer$1.allocUnsafeSlow=function(e){return allocUnsafe(e)},Buffer$1.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==Buffer$1.prototype},Buffer$1.compare=function(e,t){if(isInstance(e,Uint8Array)&&(e=Buffer$1.from(e,e.offset,e.byteLength)),isInstance(t,Uint8Array)&&(t=Buffer$1.from(t,t.offset,t.byteLength)),!Buffer$1.isBuffer(e)||!Buffer$1.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let s=0,i=Math.min(r,n);s<i;++s)if(e[s]!==t[s]){r=e[s],n=t[s];break}return r<n?-1:n<r?1:0},Buffer$1.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer$1.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer$1.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=Buffer$1.allocUnsafe(t);let s=0;for(r=0;r<e.length;++r){let t=e[r];if(isInstance(t,Uint8Array))s+t.length>n.length?(Buffer$1.isBuffer(t)||(t=Buffer$1.from(t.buffer,t.byteOffset,t.byteLength)),t.copy(n,s)):Uint8Array.prototype.set.call(n,t,s);else{if(!Buffer$1.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,s)}s+=t.length}return n},Buffer$1.byteLength=byteLength,Buffer$1.prototype._isBuffer=!0,Buffer$1.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer$1.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer$1.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer$1.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):Reflect.apply(slowToString,this,arguments)},Buffer$1.prototype.toLocaleString=Buffer$1.prototype.toString,Buffer$1.prototype.equals=function(e){if(!Buffer$1.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer$1.compare(this,e)},Buffer$1.prototype.inspect=function(){let e="";return e=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(e+=" ... "),"<Buffer "+e+">"},s&&(Buffer$1.prototype[s]=Buffer$1.prototype.inspect),Buffer$1.prototype.compare=function(e,t,r,n,s){if(isInstance(e,Uint8Array)&&(e=Buffer$1.from(e,e.offset,e.byteLength)),!Buffer$1.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),t<0||r>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=r)return 0;if(n>=s)return-1;if(t>=r)return 1;if(this===e)return 0;let i=(s>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(i,o),l=this.slice(n,s),u=e.slice(t,r);for(let e=0;e<a;++e)if(l[e]!==u[e]){i=l[e],o=u[e];break}return i<o?-1:o<i?1:0},Buffer$1.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer$1.prototype.indexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer$1.prototype.lastIndexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer$1.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!Number.isFinite(t))throw new TypeError("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,Number.isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const s=this.length-t;if((void 0===r||r>s)&&(r=s),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return utf8Write(this,e,t,r);case"ascii":case"latin1":case"binary":return asciiWrite(this,e,t,r);case"base64":return base64Write(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},Buffer$1.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const o=4096;function asciiSlice(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(127&e[s]);return n}function latin1Slice(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(e[s]);return n}function hexSlice(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let s="";for(let n=t;n<r;++n)s+=u[e[n]];return s}function utf16leSlice(e,t,r){const n=e.slice(t,r);let s="";for(let e=0;e<n.length-1;e+=2)s+=String.fromCharCode(n[e]+256*n[e+1]);return s}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,n,s,i){if(!Buffer$1.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function wrtBigUInt64LE(e,t,r,n,s){checkIntBI(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function wrtBigUInt64BE(e,t,r,n,s){checkIntBI(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r+7]=i,i>>=8,e[r+6]=i,i>>=8,e[r+5]=i,i>>=8,e[r+4]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function checkIEEE754(e,t,r,n,s,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,n,s){return t=+t,r>>>=0,s||checkIEEE754(e,0,r,4),write(e,t,r,n,23,4),r+4}function writeDouble(e,t,r,n,s){return t=+t,r>>>=0,s||checkIEEE754(e,0,r,8),write(e,t,r,n,52,8),r+8}Buffer$1.prototype.slice=function(e,t){const r=this.length;(e=Math.trunc(e))<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:Math.trunc(t))<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,Buffer$1.prototype),n},Buffer$1.prototype.readUintLE=Buffer$1.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return n},Buffer$1.prototype.readUintBE=Buffer$1.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n},Buffer$1.prototype.readUint8=Buffer$1.prototype.readUInt8=function(e,t){return e>>>=0,t||checkOffset(e,1,this.length),this[e]},Buffer$1.prototype.readUint16LE=Buffer$1.prototype.readUInt16LE=function(e,t){return e>>>=0,t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer$1.prototype.readUint16BE=Buffer$1.prototype.readUInt16BE=function(e,t){return e>>>=0,t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer$1.prototype.readUint32LE=Buffer$1.prototype.readUInt32LE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer$1.prototype.readUint32BE=Buffer$1.prototype.readUInt32BE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer$1.prototype.readBigUInt64LE=defineBigIntMethod((function(e){validateNumber(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||boundsError(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,s=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))})),Buffer$1.prototype.readBigUInt64BE=defineBigIntMethod((function(e){validateNumber(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||boundsError(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],s=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(s)})),Buffer$1.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n},Buffer$1.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);let n=t,s=1,i=this[e+--n];for(;n>0&&(s*=256);)i+=this[e+--n]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},Buffer$1.prototype.readInt8=function(e,t){return e>>>=0,t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer$1.prototype.readInt16LE=function(e,t){e>>>=0,t||checkOffset(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer$1.prototype.readInt16BE=function(e,t){e>>>=0,t||checkOffset(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer$1.prototype.readInt32LE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer$1.prototype.readInt32BE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer$1.prototype.readBigInt64LE=defineBigIntMethod((function(e){validateNumber(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||boundsError(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),Buffer$1.prototype.readBigInt64BE=defineBigIntMethod((function(e){validateNumber(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||boundsError(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),Buffer$1.prototype.readFloatLE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),read(this,e,!0,23,4)},Buffer$1.prototype.readFloatBE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),read(this,e,!1,23,4)},Buffer$1.prototype.readDoubleLE=function(e,t){return e>>>=0,t||checkOffset(e,8,this.length),read(this,e,!0,52,8)},Buffer$1.prototype.readDoubleBE=function(e,t){return e>>>=0,t||checkOffset(e,8,this.length),read(this,e,!1,52,8)},Buffer$1.prototype.writeUintLE=Buffer$1.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){checkInt(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=1,i=0;for(this[t]=255&e;++i<r&&(s*=256);)this[t+i]=e/s&255;return t+r},Buffer$1.prototype.writeUintBE=Buffer$1.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){checkInt(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=r-1,i=1;for(this[t+s]=255&e;--s>=0&&(i*=256);)this[t+s]=e/i&255;return t+r},Buffer$1.prototype.writeUint8=Buffer$1.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,1,255,0),this[t]=255&e,t+1},Buffer$1.prototype.writeUint16LE=Buffer$1.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},Buffer$1.prototype.writeUint16BE=Buffer$1.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},Buffer$1.prototype.writeUint32LE=Buffer$1.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},Buffer$1.prototype.writeUint32BE=Buffer$1.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Buffer$1.prototype.writeBigUInt64LE=defineBigIntMethod((function(e,t=0){return wrtBigUInt64LE(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),Buffer$1.prototype.writeBigUInt64BE=defineBigIntMethod((function(e,t=0){return wrtBigUInt64BE(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),Buffer$1.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);checkInt(this,e,t,r,n-1,-n)}let s=0,i=1,o=0;for(this[t]=255&e;++s<r&&(i*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=Math.trunc(e/i)-o&255;return t+r},Buffer$1.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);checkInt(this,e,t,r,n-1,-n)}let s=r-1,i=1,o=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=Math.trunc(e/i)-o&255;return t+r},Buffer$1.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer$1.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},Buffer$1.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},Buffer$1.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},Buffer$1.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Buffer$1.prototype.writeBigInt64LE=defineBigIntMethod((function(e,t=0){return wrtBigUInt64LE(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),Buffer$1.prototype.writeBigInt64BE=defineBigIntMethod((function(e,t=0){return wrtBigUInt64BE(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),Buffer$1.prototype.writeFloatLE=function(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer$1.prototype.writeFloatBE=function(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer$1.prototype.writeDoubleLE=function(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer$1.prototype.writeDoubleBE=function(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer$1.prototype.copy=function(e,t,r,n){if(!Buffer$1.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const s=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),s},Buffer$1.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer$1.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let s;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{const i=Buffer$1.isBuffer(e)?e:Buffer$1.from(e,n),o=i.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<r-t;++s)this[s+t]=i[s%o]}return this};const a={};function E(e,t,r){a[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:Reflect.apply(t,this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function addNumericalSeparator(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function checkIntBI(e,t,r,n,s,i){if(e>r||e<t){const r="bigint"==typeof t?"n":"";let n;throw n=0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`,new a.ERR_OUT_OF_RANGE("value",n,e)}!function(e,t,r){validateNumber(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||boundsError(t,e.length-(r+1))}(n,s,i)}function validateNumber(e,t){if("number"!=typeof e)throw new a.ERR_INVALID_ARG_TYPE(t,"number",e)}function boundsError(e,t,r){if(Math.floor(e)!==e)throw validateNumber(e,r),new a.ERR_OUT_OF_RANGE("offset","an integer",e);if(t<0)throw new a.ERR_BUFFER_OUT_OF_BOUNDS;throw new a.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,e)}E("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),E("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),E("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,s=r;return Number.isInteger(r)&&Math.abs(r)>2**32?s=addNumericalSeparator(String(r)):"bigint"==typeof r&&(s=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(s=addNumericalSeparator(s)),s+="n"),n+=` It must be ${t}. Received ${s}`,n}),RangeError);const l=/[^\w+/-]/g;function utf8ToBytes(e,t){let r;t=t||Number.POSITIVE_INFINITY;const n=e.length;let s=null;const i=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function base64ToBytes(e){return toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(l,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function blitBuffer(e,t,r,n){let s;for(s=0;s<n&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}function isInstance(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function numberIsNaN(e){return e!=e}const u=function(){const e="0123456789abcdef",t=Array.from({length:256});for(let r=0;r<16;++r){const n=16*r;for(let s=0;s<16;++s)t[n+s]=e[r]+e[s]}return t}();function defineBigIntMethod(e){return"undefined"==typeof BigInt?BufferBigIntNotDefined:e}function BufferBigIntNotDefined(){throw new Error("BigInt not supported")}const c=globalThis.Buffer||Buffer$1;notImplemented("buffer.resolveObjectURL"),notImplemented("buffer.transcode"),notImplemented("buffer.isUtf8"),notImplemented("buffer.isAscii");const f={};let h,d;function defaultSetTimeout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(h===setTimeout)return setTimeout(e,0);if((h===defaultSetTimeout||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch{try{return h.call(null,e,0)}catch{return h.call(this,e,0)}}}!function(){try{h="function"==typeof setTimeout?setTimeout:defaultSetTimeout}catch{h=defaultSetTimeout}try{d="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch{d=defaultClearTimeout}}();let p,m=[],y=!1,g=-1;function cleanUpNextTick(){y&&p&&(y=!1,p.length>0?m=[...p,...m]:g=-1,m.length>0&&drainQueue())}function drainQueue(){if(y)return;const e=runTimeout(cleanUpNextTick);y=!0;let t=m.length;for(;t;){for(p=m,m=[];++g<t;)p&&p[g].run();g=-1,t=m.length}p=null,y=!1,function(e){if(d===clearTimeout)return clearTimeout(e);if((d===defaultClearTimeout||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch{try{return d.call(null,e)}catch{return d.call(this,e)}}}(e)}function Item(e,t){this.fun=e,this.array=t}f.nextTick=function(e){const t=Array.from({length:arguments.length-1});if(arguments.length>1)for(let e=1;e<arguments.length;e++)t[e-1]=arguments[e];m.push(new Item(e,t)),1!==m.length||y||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},f.title="unenv";const b=Object.create(null),w=globalThis.process?.env,_getEnv=e=>w||globalThis.__env__||(e?b:globalThis);function noop(){return f}f.env=new Proxy(b,{get:(e,t)=>_getEnv()[t]??b[t],has:(e,t)=>t in _getEnv()||t in b,set:(e,t,r)=>(_getEnv(!0)[t]=r,!0),deleteProperty(e,t){delete _getEnv(!0)[t]},ownKeys(){const e=_getEnv();return Object.keys(e)}}),f.argv=[],f.version="",f.versions={},f.on=noop,f.addListener=noop,f.once=noop,f.off=noop,f.removeListener=noop,f.removeAllListeners=noop,f.emit=noop,f.prependListener=noop,f.prependOnceListener=noop,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("[unenv] process.binding is not supported")};let S="/";f.cwd=function(){return S},f.chdir=function(e){S=e},f.umask=function(){return 0};const v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};v.process=v.process||f;const _=v.process,B=/#/g,T=/&/g,L=/\//g,R=/=/g,q=/\+/g,$=/%5e/gi,x=/%60/gi,C=/%7c/gi,A=/%20/gi;function encodeQueryValue(e){return(t="string"==typeof e?e:JSON.stringify(e),encodeURI(""+t).replace(C,"|")).replace(q,"%2B").replace(A,"+").replace(B,"%23").replace(T,"%26").replace(x,"`").replace($,"^").replace(L,"%2F");var t}function encodeQueryKey(e){return encodeQueryValue(e).replace(R,"%3D")}function decode(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function decodeQueryValue(e){return decode(e.replace(q," "))}function parseQuery(e=""){const t={};"?"===e[0]&&(e=e.slice(1));for(const r of e.split("&")){const e=r.match(/([^=]+)=?(.*)/)||[];if(e.length<2)continue;const n=decode(e[1].replace(q," "));if("__proto__"===n||"constructor"===n)continue;const s=decodeQueryValue(e[2]||"");void 0===t[n]?t[n]=s:Array.isArray(t[n])?t[n].push(s):t[n]=[t[n],s]}return t}function stringifyQuery(e){return Object.keys(e).filter((t=>void 0!==e[t])).map((t=>{return r=t,"number"!=typeof(n=e[t])&&"boolean"!=typeof n||(n=String(n)),n?Array.isArray(n)?n.map((e=>`${encodeQueryKey(r)}=${encodeQueryValue(e)}`)).join("&"):`${encodeQueryKey(r)}=${encodeQueryValue(n)}`:encodeQueryKey(r);var r,n})).filter(Boolean).join("&")}const N=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,I=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,Q=/^([/\\]\s*){2,}[^/\\]/,k=/^[\s\0]*(blob|data|javascript|vbscript):$/i,O=/\/$|\/\?|\/#/,P=/^\.?\//;function hasProtocol(e,t={}){return"boolean"==typeof t&&(t={acceptRelative:t}),t.strict?N.test(e):I.test(e)||!!t.acceptRelative&&Q.test(e)}function isScriptProtocol(e){return!!e&&k.test(e)}function hasTrailingSlash(e="",t){return t?O.test(e):e.endsWith("/")}function withoutTrailingSlash(e="",t){if(!t)return(hasTrailingSlash(e)?e.slice(0,-1):e)||"/";if(!hasTrailingSlash(e,!0))return e||"/";let r=e,n="";const s=e.indexOf("#");s>=0&&(r=e.slice(0,s),n=e.slice(s));const[i,...o]=r.split("?");return((i.endsWith("/")?i.slice(0,-1):i)||"/")+(o.length>0?`?${o.join("?")}`:"")+n}function withTrailingSlash(e="",t){if(!t)return e.endsWith("/")?e:e+"/";if(hasTrailingSlash(e,!0))return e||"/";let r=e,n="";const s=e.indexOf("#");if(s>=0&&(r=e.slice(0,s),n=e.slice(s),!r))return n;const[i,...o]=r.split("?");return i+"/"+(o.length>0?`?${o.join("?")}`:"")+n}function withLeadingSlash(e=""){return function(e=""){return e.startsWith("/")}(e)?e:"/"+e}function withoutBase(e,t){if(isEmptyURL(t))return e;const r=withoutTrailingSlash(t);if(!e.startsWith(r))return e;const n=e.slice(r.length);return"/"===n[0]?n:"/"+n}function withQuery(e,t){const r=parseURL(e),n={...parseQuery(r.search),...t};return r.search=stringifyQuery(n),function(e){const t=e.pathname||"",r=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",n=e.hash||"",s=e.auth?e.auth+"@":"",i=e.host||"",o=e.protocol||e[j]?(e.protocol||"")+"//":"";return o+s+i+t+r+n}(r)}function getQuery$1(e){return parseQuery(parseURL(e).search)}function isEmptyURL(e){return!e||"/"===e}function joinURL(e,...t){let r=e||"";for(const e of t.filter((e=>function(e){return e&&"/"!==e}(e))))if(r){const t=e.replace(P,"");r=withTrailingSlash(r)+t}else r=e;return r}function joinRelativeURL(...e){const t=/\/(?!\/)/,r=e.filter(Boolean),n=[];let s=0;for(const e of r)if(e&&"/"!==e)for(const[r,i]of e.split(t).entries())if(i&&"."!==i)if(".."!==i)1===r&&n[n.length-1]?.endsWith(":/")?n[n.length-1]+="/"+i:(n.push(i),s++);else{if(1===n.length&&hasProtocol(n[0]))continue;n.pop(),s--}let i=n.join("/");return s>=0?r[0]?.startsWith("/")&&!i.startsWith("/")?i="/"+i:r[0]?.startsWith("./")&&!i.startsWith("./")&&(i="./"+i):i="../".repeat(-1*s)+i,r[r.length-1]?.endsWith("/")&&!i.endsWith("/")&&(i+="/"),i}const j=Symbol.for("ufo:protocolRelative");function parseURL(e="",t){const r=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(r){const[,e,t=""]=r;return{protocol:e.toLowerCase(),pathname:t,href:e+t,auth:"",host:"",search:"",hash:""}}if(!hasProtocol(e,{acceptRelative:!0}))return parsePath(e);const[,n="",s,i=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,o="",a=""]=i.match(/([^#/?]*)(.*)?/)||[];"file:"===n&&(a=a.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:l,search:u,hash:c}=parsePath(a);return{protocol:n.toLowerCase(),auth:s?s.slice(0,Math.max(0,s.length-1)):"",host:o,pathname:l,search:u,hash:c,[j]:!n}}function parsePath(e=""){const[t="",r="",n=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:r,hash:n}}const M=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function objectHash(e,t){const r=createHasher(t=t?{...M,...t}:M);return r.dispatch(e),r.toString()}const U=Object.freeze(["prototype","__proto__","constructor"]);function createHasher(e){let t="",r=new Map;const write=e=>{t+=e};return{toString:()=>t,getContext:()=>r,dispatch(t){e.replacer&&(t=e.replacer(t));return this[null===t?"null":typeof t](t)},object(t){if(t&&"function"==typeof t.toJSON)return this.object(t.toJSON());const n=Object.prototype.toString.call(t);let s="";const i=n.length;s=i<10?"unknown:["+n+"]":n.slice(8,i-1),s=s.toLowerCase();let o=null;if(void 0!==(o=r.get(t)))return this.dispatch("[CIRCULAR:"+o+"]");if(r.set(t,r.size),void 0!==c&&c.isBuffer&&c.isBuffer(t))return write("buffer:"),write(t.toString("utf8"));if("object"!==s&&"function"!==s&&"asyncfunction"!==s)this[s]?this[s](t):e.ignoreUnknown||this.unkown(t,s);else{let r=Object.keys(t);e.unorderedObjects&&(r=r.sort());let n=[];!1===e.respectType||isNativeFunction(t)||(n=U),e.excludeKeys&&(r=r.filter((t=>!e.excludeKeys(t))),n=n.filter((t=>!e.excludeKeys(t)))),write("object:"+(r.length+n.length)+":");const dispatchForKey=r=>{this.dispatch(r),write(":"),e.excludeValues||this.dispatch(t[r]),write(",")};for(const e of r)dispatchForKey(e);for(const e of n)dispatchForKey(e)}},array(t,n){if(n=void 0===n?!1!==e.unorderedArrays:n,write("array:"+t.length+":"),!n||t.length<=1){for(const e of t)this.dispatch(e);return}const s=new Map,i=t.map((t=>{const r=createHasher(e);r.dispatch(t);for(const[e,t]of r.getContext())s.set(e,t);return r.toString()}));return r=s,i.sort(),this.array(i,!1)},date:e=>write("date:"+e.toJSON()),symbol:e=>write("symbol:"+e.toString()),unkown(e,t){if(write(t),e)return write(":"),e&&"function"==typeof e.entries?this.array(Array.from(e.entries()),!0):void 0},error:e=>write("error:"+e.toString()),boolean:e=>write("bool:"+e),string(e){write("string:"+e.length+":"),write(e)},function(t){write("fn:"),isNativeFunction(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this.object(t)},number:e=>write("number:"+e),xml:e=>write("xml:"+e.toString()),null:()=>write("Null"),undefined:()=>write("Undefined"),regexp:e=>write("regex:"+e.toString()),uint8array(e){return write("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},uint8clampedarray(e){return write("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},int8array(e){return write("int8array:"),this.dispatch(Array.prototype.slice.call(e))},uint16array(e){return write("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},int16array(e){return write("int16array:"),this.dispatch(Array.prototype.slice.call(e))},uint32array(e){return write("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},int32array(e){return write("int32array:"),this.dispatch(Array.prototype.slice.call(e))},float32array(e){return write("float32array:"),this.dispatch(Array.prototype.slice.call(e))},float64array(e){return write("float64array:"),this.dispatch(Array.prototype.slice.call(e))},arraybuffer(e){return write("arraybuffer:"),this.dispatch(new Uint8Array(e))},url:e=>write("url:"+e.toString()),map(t){write("map:");const r=[...t];return this.array(r,!1!==e.unorderedSets)},set(t){write("set:");const r=[...t];return this.array(r,!1!==e.unorderedSets)},file(e){return write("file:"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},blob(){if(e.ignoreUnknown)return write("[blob]");throw new Error('Hashing Blob objects is currently not supported\nUse "options.replacer" or "options.ignoreUnknown"\n')},domwindow:()=>write("domwindow"),bigint:e=>write("bigint:"+e.toString()),process:()=>write("process"),timer:()=>write("timer"),pipe:()=>write("pipe"),tcp:()=>write("tcp"),udp:()=>write("udp"),tty:()=>write("tty"),statwatcher:()=>write("statwatcher"),securecontext:()=>write("securecontext"),connection:()=>write("connection"),zlib:()=>write("zlib"),context:()=>write("context"),nodescript:()=>write("nodescript"),httpparser:()=>write("httpparser"),dataview:()=>write("dataview"),signal:()=>write("signal"),fsevent:()=>write("fsevent"),tlswrap:()=>write("tlswrap")}}const H="[native code] }",D=H.length;function isNativeFunction(e){return"function"==typeof e&&Function.prototype.toString.call(e).slice(-D)===H}class WordArray{constructor(e,t){e=this.words=e||[],this.sigBytes=void 0===t?4*e.length:t}toString(e){return(e||F).stringify(this)}concat(e){if(this.clamp(),this.sigBytes%4)for(let t=0;t<e.sigBytes;t++){const r=e.words[t>>>2]>>>24-t%4*8&255;this.words[this.sigBytes+t>>>2]|=r<<24-(this.sigBytes+t)%4*8}else for(let t=0;t<e.sigBytes;t+=4)this.words[this.sigBytes+t>>>2]=e.words[t>>>2];return this.sigBytes+=e.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new WordArray([...this.words])}}const F={stringify(e){const t=[];for(let r=0;r<e.sigBytes;r++){const n=e.words[r>>>2]>>>24-r%4*8&255;t.push((n>>>4).toString(16),(15&n).toString(16))}return t.join("")}},z={stringify(e){const t=[];for(let r=0;r<e.sigBytes;r+=3){const n=(e.words[r>>>2]>>>24-r%4*8&255)<<16|(e.words[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|e.words[r+2>>>2]>>>24-(r+2)%4*8&255;for(let s=0;s<4&&8*r+6*s<8*e.sigBytes;s++)t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n>>>6*(3-s)&63))}return t.join("")}},K={parse(e){const t=e.length,r=[];for(let n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new WordArray(r,t)}},W={parse:e=>K.parse(unescape(encodeURIComponent(e)))};class BufferedBlockAlgorithm{constructor(){this._data=new WordArray,this._nDataBytes=0,this._minBufferSize=0,this.blockSize=16}reset(){this._data=new WordArray,this._nDataBytes=0}_append(e){"string"==typeof e&&(e=W.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_doProcessBlock(e,t){}_process(e){let t,r=this._data.sigBytes/(4*this.blockSize);r=e?Math.ceil(r):Math.max((0|r)-this._minBufferSize,0);const n=r*this.blockSize,s=Math.min(4*n,this._data.sigBytes);if(n){for(let e=0;e<n;e+=this.blockSize)this._doProcessBlock(this._data.words,e);t=this._data.words.splice(0,n),this._data.sigBytes-=s}return new WordArray(t,s)}}class Hasher extends BufferedBlockAlgorithm{update(e){return this._append(e),this._process(),this}finalize(e){e&&this._append(e)}}const V=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],J=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],G=[];class SHA256 extends Hasher{constructor(){super(...arguments),this._hash=new WordArray([...V])}reset(){super.reset(),this._hash=new WordArray([...V])}_doProcessBlock(e,t){const r=this._hash.words;let n=r[0],s=r[1],i=r[2],o=r[3],a=r[4],l=r[5],u=r[6],c=r[7];for(let r=0;r<64;r++){if(r<16)G[r]=0|e[t+r];else{const e=G[r-15],t=(e<<25|e>>>7)^(e<<14|e>>>18)^e>>>3,n=G[r-2],s=(n<<15|n>>>17)^(n<<13|n>>>19)^n>>>10;G[r]=t+G[r-7]+s+G[r-16]}const f=n&s^n&i^s&i,h=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),d=c+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&u)+J[r]+G[r];c=u,u=l,l=a,a=o+d|0,o=i,i=s,s=n,n=d+(h+f)|0}r[0]=r[0]+n|0,r[1]=r[1]+s|0,r[2]=r[2]+i|0,r[3]=r[3]+o|0,r[4]=r[4]+a|0,r[5]=r[5]+l|0,r[6]=r[6]+u|0,r[7]=r[7]+c|0}finalize(e){super.finalize(e);const t=8*this._nDataBytes,r=8*this._data.sigBytes;return this._data.words[r>>>5]|=128<<24-r%32,this._data.words[14+(r+64>>>9<<4)]=Math.floor(t/4294967296),this._data.words[15+(r+64>>>9<<4)]=t,this._data.sigBytes=4*this._data.words.length,this._process(),this._hash}}function hash(e,t={}){const r="string"==typeof e?e:objectHash(e,t);return(n=r,(new SHA256).finalize(n).toString(z)).slice(0,10);var n}const Y={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function createRouter$1(e={}){const t={options:e,rootNode:createRadixNode(),staticRoutesMap:{}},normalizeTrailingSlash=t=>e.strictTrailingSlash?t:t.replace(/\/$/,"")||"/";if(e.routes)for(const r in e.routes)insert(t,normalizeTrailingSlash(r),e.routes[r]);return{ctx:t,lookup:e=>function(e,t){const r=e.staticRoutesMap[t];if(r)return r.data;const n=t.split("/"),s={};let i=!1,o=null,a=e.rootNode,l=null;for(let e=0;e<n.length;e++){const t=n[e];null!==a.wildcardChildNode&&(o=a.wildcardChildNode,l=n.slice(e).join("/"));const r=a.children.get(t);if(void 0===r){if(a&&a.placeholderChildren.length>1){const t=n.length-e;a=a.placeholderChildren.find((e=>e.maxDepth===t))||null}else a=a.placeholderChildren[0]||null;if(!a)break;a.paramName&&(s[a.paramName]=t),i=!0}else a=r}null!==a&&null!==a.data||null===o||(a=o,s[a.paramName||"_"]=l,i=!0);if(!a)return null;if(i)return{...a.data,params:i?s:void 0};return a.data}(t,normalizeTrailingSlash(e)),insert:(e,r)=>insert(t,normalizeTrailingSlash(e),r),remove:e=>function(e,t){let r=!1;const n=t.split("/");let s=e.rootNode;for(const e of n)if(s=s.children.get(e),!s)return r;if(s.data){const e=n.at(-1)||"";s.data=null,0===Object.keys(s.children).length&&s.parent&&(s.parent.children.delete(e),s.parent.wildcardChildNode=null,s.parent.placeholderChildren=[]),r=!0}return r}(t,normalizeTrailingSlash(e))}}function insert(e,t,r){let n=!0;const s=t.split("/");let i=e.rootNode,o=0;const a=[i];for(const e of s){let t;if(t=i.children.get(e))i=t;else{const r=getNodeType(e);t=createRadixNode({type:r,parent:i}),i.children.set(e,t),r===Y.PLACEHOLDER?(t.paramName="*"===e?"_"+o++:e.slice(1),i.placeholderChildren.push(t),n=!1):r===Y.WILDCARD&&(i.wildcardChildNode=t,t.paramName=e.slice(3)||"_",n=!1),a.push(t),i=t}}for(const[e,t]of a.entries())t.maxDepth=Math.max(a.length-e,t.maxDepth||0);return i.data=r,!0===n&&(e.staticRoutesMap[t]=i),i}function createRadixNode(e={}){return{type:e.type||Y.NORMAL,maxDepth:0,parent:e.parent||null,children:new Map,data:e.data||null,paramName:e.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function getNodeType(e){return e.startsWith("**")?Y.WILDCARD:":"===e[0]||"*"===e?Y.PLACEHOLDER:Y.NORMAL}function toRouteMatcher(e){return function(e,t){return{ctx:{table:e},matchAll:r=>_matchRoutes(r,e,t)}}(_routerNodeToTable("",e.ctx.rootNode),e.ctx.options.strictTrailingSlash)}function _matchRoutes(e,t,r){!0!==r&&e.endsWith("/")&&(e=e.slice(0,-1)||"/");const n=[];for(const[r,s]of _sortRoutesMap(t.wildcard))(e===r||e.startsWith(r+"/"))&&n.push(s);for(const[r,s]of _sortRoutesMap(t.dynamic))if(e.startsWith(r+"/")){const t="/"+e.slice(r.length).split("/").splice(2).join("/");n.push(..._matchRoutes(t,s))}const s=t.static.get(e);return s&&n.push(s),n.filter(Boolean)}function _sortRoutesMap(e){return[...e.entries()].sort(((e,t)=>e[0].length-t[0].length))}function _routerNodeToTable(e,t){const r={static:new Map,wildcard:new Map,dynamic:new Map};return function _addNode(e,t){if(e)if(t.type!==Y.NORMAL||e.includes("*")||e.includes(":")){if(t.type===Y.WILDCARD)r.wildcard.set(e.replace("/**",""),t.data);else if(t.type===Y.PLACEHOLDER){const n=_routerNodeToTable("",t);return t.data&&n.static.set("/",t.data),void r.dynamic.set(e.replace(/\/\*|\/:\w+/,""),n)}}else t.data&&r.static.set(e,t.data);for(const[r,n]of t.children.entries())_addNode(`${e}/${r}`.replace("//","/"),n)}(e,t),r}const Z=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,X=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,ee=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jsonParseTransform(e,t){if(!("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t))return t;!function(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}(e)}function destr(e,t={}){if("string"!=typeof e)return e;const r=e.trim();if('"'===e[0]&&e.endsWith('"')&&!e.includes("\\"))return r.slice(1,-1);if(r.length<=9){const e=r.toLowerCase();if("true"===e)return!0;if("false"===e)return!1;if("undefined"===e)return;if("null"===e)return null;if("nan"===e)return Number.NaN;if("infinity"===e)return Number.POSITIVE_INFINITY;if("-infinity"===e)return Number.NEGATIVE_INFINITY}if(!ee.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(Z.test(e)||X.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,jsonParseTransform)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}function isPlainObject(e){if(null===e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&(!(Symbol.iterator in e)&&(!(Symbol.toStringTag in e)||"[object Module]"===Object.prototype.toString.call(e)))}function _defu(e,t,r=".",n){if(!isPlainObject(t))return _defu(e,{},r,n);const s=Object.assign({},t);for(const t in e){if("__proto__"===t||"constructor"===t)continue;const i=e[t];null!=i&&(n&&n(s,t,i,r)||(Array.isArray(i)&&Array.isArray(s[t])?s[t]=[...i,...s[t]]:isPlainObject(i)&&isPlainObject(s[t])?s[t]=_defu(i,s[t],(r?`${r}.`:"")+t.toString(),n):s[t]=i))}return s}function createDefu(e){return(...t)=>t.reduce(((t,r)=>_defu(t,r,"",e)),{})}const te=createDefu(),re=createDefu(((e,t,r)=>{if(void 0!==e[t]&&"function"==typeof r)return e[t]=r(e[t]),!0}));let se=10,ie=class{__unenv__=!0;_events=Object.create(null);_maxListeners;static get defaultMaxListeners(){return se}static set defaultMaxListeners(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");se=e}setMaxListeners(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this}getMaxListeners(){return _getMaxListeners(this)}emit(e,...t){if(!this._events[e]||0===this._events[e].length)return!1;if("error"===e){let e;if(t.length>0&&(e=t[0]),e instanceof Error)throw e;const r=new Error("Unhandled error."+(e?" ("+e.message+")":""));throw r.context=e,r}for(const r of this._events[e])(r.listener||r).apply(this,t);return!0}addListener(e,t){return _addListener(this,e,t,!1)}on(e,t){return _addListener(this,e,t,!1)}prependListener(e,t){return _addListener(this,e,t,!0)}once(e,t){return this.on(e,_wrapOnce(this,e,t))}prependOnceListener(e,t){return this.prependListener(e,_wrapOnce(this,e,t))}removeListener(e,t){return function(e,t,r){if(_checkListener(r),!e._events[t]||0===e._events[t].length)return e;const n=e._events[t].length;if(e._events[t]=e._events[t].filter((e=>e!==r)),n===e._events[t].length)return e;e._events.removeListener&&e.emit("removeListener",t,r.listener||r);0===e._events[t].length&&delete e._events[t];return e}(this,e,t)}off(e,t){return this.removeListener(e,t)}removeAllListeners(e){return function(e,t){if(!e._events[t]||0===e._events[t].length)return e;if(e._events.removeListener)for(const r of e._events[t])e.emit("removeListener",t,r.listener||r);return delete e._events[t],e}(this,e)}listeners(e){return _listeners(this,e,!0)}rawListeners(e){return _listeners(this,e,!1)}listenerCount(e){return this.rawListeners(e).length}eventNames(){return Object.keys(this._events)}};function _addListener(e,t,r,n){_checkListener(r),void 0!==e._events.newListener&&e.emit("newListener",t,r.listener||r),e._events[t]||(e._events[t]=[]),n?e._events[t].unshift(r):e._events[t].push(r);const s=_getMaxListeners(e);if(s>0&&e._events[t].length>s&&!e._events[t].warned){e._events[t].warned=!0;const r=new Error(`[unenv] Possible EventEmitter memory leak detected. ${e._events[t].length} ${t} listeners added. Use emitter.setMaxListeners() to increase limit`);r.name="MaxListenersExceededWarning",r.emitter=e,r.type=t,r.count=e._events[t]?.length,console.warn(r)}return e}function _wrapOnce(e,t,r){let n=!1;const wrapper=(...s)=>{if(!n)return e.removeListener(t,wrapper),n=!0,0===s.length?r.call(e):r.apply(e,s)};return wrapper.listener=r,wrapper}function _getMaxListeners(e){return e._maxListeners??ie.defaultMaxListeners}function _listeners(e,t,r){let n=e._events[t];return"function"==typeof n&&(n=[n]),r?n.map((e=>e.listener||e)):n}function _checkListener(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}const oe=globalThis.EventEmitter||ie;class _Readable extends oe{__unenv__=!0;readableEncoding=null;readableEnded=!0;readableFlowing=!1;readableHighWaterMark=0;readableLength=0;readableObjectMode=!1;readableAborted=!1;readableDidRead=!1;closed=!1;errored=null;readable=!1;destroyed=!1;static from(e,t){return new _Readable(t)}constructor(e){super()}_read(e){}read(e){}setEncoding(e){return this}pause(){return this}resume(){return this}isPaused(){return!0}unpipe(e){return this}unshift(e,t){}wrap(e){return this}push(e,t){return!1}_destroy(e,t){this.removeAllListeners()}destroy(e){return this.destroyed=!0,this._destroy(e),this}pipe(e,t){return{}}compose(e,t){throw new Error("[unenv] Method not implemented.")}[Symbol.asyncDispose](){return this.destroy(),Promise.resolve()}async*[Symbol.asyncIterator](){throw createNotImplementedError("Readable.asyncIterator")}iterator(e){throw createNotImplementedError("Readable.iterator")}map(e,t){throw createNotImplementedError("Readable.map")}filter(e,t){throw createNotImplementedError("Readable.filter")}forEach(e,t){throw createNotImplementedError("Readable.forEach")}reduce(e,t,r){throw createNotImplementedError("Readable.reduce")}find(e,t){throw createNotImplementedError("Readable.find")}findIndex(e,t){throw createNotImplementedError("Readable.findIndex")}some(e,t){throw createNotImplementedError("Readable.some")}toArray(e){throw createNotImplementedError("Readable.toArray")}every(e,t){throw createNotImplementedError("Readable.every")}flatMap(e,t){throw createNotImplementedError("Readable.flatMap")}drop(e,t){throw createNotImplementedError("Readable.drop")}take(e,t){throw createNotImplementedError("Readable.take")}asIndexedPairs(e){throw createNotImplementedError("Readable.asIndexedPairs")}}const ae=globalThis.Readable||_Readable;const le=globalThis.Writable||class extends oe{__unenv__=!0;writable=!0;writableEnded=!1;writableFinished=!1;writableHighWaterMark=0;writableLength=0;writableObjectMode=!1;writableCorked=0;closed=!1;errored=null;writableNeedDrain=!1;destroyed=!1;_data;_encoding="utf-8";constructor(e){super()}pipe(e,t){return{}}_write(e,t,r){if(this.writableEnded)r&&r();else{if(void 0===this._data)this._data=e;else{const r="string"==typeof this._data?c.from(this._data,this._encoding||t||"utf8"):this._data,n="string"==typeof e?c.from(e,t||this._encoding||"utf8"):e;this._data=c.concat([r,n])}this._encoding=t,r&&r()}}_writev(e,t){}_destroy(e,t){}_final(e){}write(e,t,r){const n="string"==typeof t?this._encoding:"utf-8",s="function"==typeof t?t:"function"==typeof r?r:void 0;return this._write(e,n,s),!0}setDefaultEncoding(e){return this}end(e,t,r){const n="function"==typeof e?e:"function"==typeof t?t:"function"==typeof r?r:void 0;if(this.writableEnded)return n&&n(),this;const s=e===n?void 0:e;if(s){const e=t===n?void 0:t;this.write(s,e,n)}return this.writableEnded=!0,this.writableFinished=!0,this.emit("close"),this.emit("finish"),this}cork(){}uncork(){}destroy(e){return this.destroyed=!0,delete this._data,this.removeAllListeners(),this}compose(e,t){throw new Error("[h3] Method not implemented.")}},ue=class{allowHalfOpen=!0;_destroy;constructor(e=new ae,t=new le){Object.assign(this,e),Object.assign(this,t),this._destroy=function(...e){return function(...t){for(const r of e)r(...t)}}(e._destroy,t._destroy)}};function getDuplex(){return Object.assign(ue.prototype,ae.prototype),Object.assign(ue.prototype,le.prototype),ue}const ce=getDuplex(),fe=globalThis.Duplex||ce;class Socket extends fe{__unenv__=!0;bufferSize=0;bytesRead=0;bytesWritten=0;connecting=!1;destroyed=!1;pending=!1;localAddress="";localPort=0;remoteAddress="";remoteFamily="";remotePort=0;autoSelectFamilyAttemptedAddresses=[];readyState="readOnly";constructor(e){super()}write(e,t,r){return!1}connect(e,t,r){return this}end(e,t,r){return this}setEncoding(e){return this}pause(){return this}resume(){return this}setTimeout(e,t){return this}setNoDelay(e){return this}setKeepAlive(e,t){return this}address(){return{}}unref(){return this}ref(){return this}destroySoon(){this.destroy()}resetAndDestroy(){const e=new Error("ERR_SOCKET_CLOSED");return e.code="ERR_SOCKET_CLOSED",this.destroy(e),this}}class IncomingMessage extends ae{__unenv__={};aborted=!1;httpVersion="1.1";httpVersionMajor=1;httpVersionMinor=1;complete=!0;connection;socket;headers={};trailers={};method="GET";url="/";statusCode=200;statusMessage="";closed=!1;errored=null;readable=!1;constructor(e){super(),this.socket=this.connection=e||new Socket}get rawHeaders(){return function(e){const t=[];for(const r in e)if(Array.isArray(e[r]))for(const n of e[r])t.push(r,n);else t.push(r,e[r]);return t}(this.headers)}get rawTrailers(){return[]}setTimeout(e,t){return this}get headersDistinct(){return _distinct(this.headers)}get trailersDistinct(){return _distinct(this.trailers)}}function _distinct(e){const t={};for(const[r,n]of Object.entries(e))r&&(t[r]=(Array.isArray(n)?n:[n]).filter(Boolean));return t}class ServerResponse extends le{__unenv__=!0;statusCode=200;statusMessage="";upgrading=!1;chunkedEncoding=!1;shouldKeepAlive=!1;useChunkedEncodingByDefault=!1;sendDate=!1;finished=!1;headersSent=!1;strictContentLength=!1;connection=null;socket=null;req;_headers={};constructor(e){super(),this.req=e}assignSocket(e){e._httpMessage=this,this.socket=e,this.connection=e,this.emit("socket",e),this._flush()}_flush(){this.flushHeaders()}detachSocket(e){}writeContinue(e){}writeHead(e,t,r){e&&(this.statusCode=e),"string"==typeof t&&(this.statusMessage=t,t=void 0);const n=r||t;if(n)if(Array.isArray(n));else for(const e in n)this.setHeader(e,n[e]);return this.headersSent=!0,this}writeProcessing(){}setTimeout(e,t){return this}appendHeader(e,t){e=e.toLowerCase();const r=this._headers[e],n=[...Array.isArray(r)?r:[r],...Array.isArray(t)?t:[t]].filter(Boolean);return this._headers[e]=n.length>1?n:n[0],this}setHeader(e,t){return this._headers[e.toLowerCase()]=t,this}getHeader(e){return this._headers[e.toLowerCase()]}getHeaders(){return this._headers}getHeaderNames(){return Object.keys(this._headers)}hasHeader(e){return e.toLowerCase()in this._headers}removeHeader(e){delete this._headers[e.toLowerCase()]}addTrailers(e){}flushHeaders(){}writeEarlyHints(e,t){"function"==typeof t&&t()}}function hasProp(e,t){try{return t in e}catch{return!1}}var he=Object.defineProperty,__publicField$2=(e,t,r)=>(((e,t,r)=>{t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class H3Error extends Error{constructor(e,t={}){super(e,t),__publicField$2(this,"statusCode",500),__publicField$2(this,"fatal",!1),__publicField$2(this,"unhandled",!1),__publicField$2(this,"statusMessage"),__publicField$2(this,"data"),__publicField$2(this,"cause"),t.cause&&!this.cause&&(this.cause=t.cause)}toJSON(){const e={message:this.message,statusCode:sanitizeStatusCode(this.statusCode,500)};return this.statusMessage&&(e.statusMessage=sanitizeStatusMessage(this.statusMessage)),void 0!==this.data&&(e.data=this.data),e}}function createError(e){if("string"==typeof e)return new H3Error(e);if(isError(e))return e;const t=new H3Error(e.message??e.statusMessage??"",{cause:e.cause||e});if(hasProp(e,"stack"))try{Object.defineProperty(t,"stack",{get:()=>e.stack})}catch{try{t.stack=e.stack}catch{}}if(e.data&&(t.data=e.data),e.statusCode?t.statusCode=sanitizeStatusCode(e.statusCode,t.statusCode):e.status&&(t.statusCode=sanitizeStatusCode(e.status,t.statusCode)),e.statusMessage?t.statusMessage=e.statusMessage:e.statusText&&(t.statusMessage=e.statusText),t.statusMessage){const e=t.statusMessage;sanitizeStatusMessage(t.statusMessage)!==e&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return void 0!==e.fatal&&(t.fatal=e.fatal),void 0!==e.unhandled&&(t.unhandled=e.unhandled),t}function isError(e){return!0===e?.constructor?.__h3_error__}function getQuery(e){return getQuery$1(e.path||"")}function getRequestHeaders(e){const t={};for(const r in e.node.req.headers){const n=e.node.req.headers[r];t[r]=Array.isArray(n)?n.filter(Boolean).join(", "):n}return t}__publicField$2(H3Error,"__h3_error__",!0);const de=Symbol.for("h3RawBody"),pe=["PATCH","POST","PUT","DELETE"];function readRawBody(e,t="utf8"){!function(e,t){if(!function(e,t){if("string"==typeof t){if(e.method===t)return!0}else if(t.includes(e.method))return!0;return!1}(e,t))throw createError({statusCode:405,statusMessage:"HTTP method is not allowed."})}(e,pe);const r=e._requestBody||e.web?.request?.body||e.node.req[de]||e.node.req.rawBody||e.node.req.body;if(r){const e=Promise.resolve(r).then((e=>c.isBuffer(e)?e:"function"==typeof e.pipeTo?new Promise(((t,r)=>{const n=[];e.pipeTo(new WritableStream({write(e){n.push(e)},close(){t(c.concat(n))},abort(e){r(e)}})).catch(r)})):"function"==typeof e.pipe?new Promise(((t,r)=>{const n=[];e.on("data",(e=>{n.push(e)})).on("end",(()=>{t(c.concat(n))})).on("error",r)})):e.constructor===Object?c.from(JSON.stringify(e)):c.from(e)));return t?e.then((e=>e.toString(t))):e}if(!Number.parseInt(e.node.req.headers["content-length"]||"")&&!String(e.node.req.headers["transfer-encoding"]??"").split(",").map((e=>e.trim())).filter(Boolean).includes("chunked"))return Promise.resolve(void 0);const n=e.node.req[de]=new Promise(((t,r)=>{const n=[];e.node.req.on("error",(e=>{r(e)})).on("data",(e=>{n.push(e)})).on("end",(()=>{t(c.concat(n))}))}));return t?n.then((e=>e.toString(t))):n}function handleCacheHeaders(e,t){const r=["public",...t.cacheControls||[]];let n=!1;if(void 0!==t.maxAge&&r.push("max-age="+ +t.maxAge,"s-maxage="+ +t.maxAge),t.modifiedTime){const r=new Date(t.modifiedTime),s=e.node.req.headers["if-modified-since"];e.node.res.setHeader("last-modified",r.toUTCString()),s&&new Date(s)>=t.modifiedTime&&(n=!0)}if(t.etag){e.node.res.setHeader("etag",t.etag);e.node.req.headers["if-none-match"]===t.etag&&(n=!0)}return e.node.res.setHeader("cache-control",r.join(", ")),!!n&&(e.node.res.statusCode=304,e.handled||e.node.res.end(),!0)}const me={html:"text/html",json:"application/json"},ye=/[^\u0009\u0020-\u007E]/g;function sanitizeStatusMessage(e=""){return e.replace(ye,"")}function sanitizeStatusCode(e,t=200){return e?("string"==typeof e&&(e=Number.parseInt(e,10)),e<100||e>999?t:e):t}function splitCookiesString(e){if(Array.isArray(e))return e.flatMap((e=>splitCookiesString(e)));if("string"!=typeof e)return[];const t=[];let r,n,s,i,o,a=0;const skipWhitespace=()=>{for(;a<e.length&&/\s/.test(e.charAt(a));)a+=1;return a<e.length};for(;a<e.length;){for(r=a,o=!1;skipWhitespace();)if(n=e.charAt(a),","===n){for(s=a,a+=1,skipWhitespace(),i=a;a<e.length&&(n=e.charAt(a),"="!==n&&";"!==n&&","!==n);)a+=1;a<e.length&&"="===e.charAt(a)?(o=!0,a=i,t.push(e.slice(r,s)),r=a):a=s+1}else a+=1;(!o||a>=e.length)&&t.push(e.slice(r,e.length))}return t}const ge="undefined"==typeof setImmediate?e=>e():setImmediate;function send(e,t,r){return r&&function(e,t){t&&304!==e.node.res.statusCode&&!e.node.res.getHeader("content-type")&&e.node.res.setHeader("content-type",t)}(e,r),new Promise((r=>{ge((()=>{e.handled||e.node.res.end(t),r()}))}))}function setResponseStatus(e,t,r){t&&(e.node.res.statusCode=sanitizeStatusCode(t,e.node.res.statusCode)),r&&(e.node.res.statusMessage=sanitizeStatusMessage(r))}function getResponseStatus(e){return e.node.res.statusCode}function getResponseStatusText(e){return e.node.res.statusMessage}function setResponseHeaders(e,t){for(const[r,n]of Object.entries(t))e.node.res.setHeader(r,n)}const be=setResponseHeaders;function setResponseHeader(e,t,r){e.node.res.setHeader(t,r)}function sendStream(e,t){if(!t||"object"!=typeof t)throw new Error("[h3] Invalid stream provided.");if(e.node.res._data=t,!e.node.res.socket)return e._handled=!0,Promise.resolve();if(hasProp(t,"pipeTo")&&"function"==typeof t.pipeTo)return t.pipeTo(new WritableStream({write(t){e.node.res.write(t)}})).then((()=>{e.node.res.end()}));if(hasProp(t,"pipe")&&"function"==typeof t.pipe)return new Promise(((r,n)=>{t.pipe(e.node.res),t.on&&(t.on("end",(()=>{e.node.res.end(),r()})),t.on("error",(e=>{n(e)}))),e.node.res.on("close",(()=>{t.abort&&t.abort()}))}));throw new Error("[h3] Invalid or incompatible stream provided.")}function sendWebResponse(e,t){for(const[r,n]of t.headers)"set-cookie"===r?e.node.res.appendHeader(r,splitCookiesString(n)):e.node.res.setHeader(r,n);if(t.status&&(e.node.res.statusCode=sanitizeStatusCode(t.status,e.node.res.statusCode)),t.statusText&&(e.node.res.statusMessage=sanitizeStatusMessage(t.statusText)),t.redirected&&e.node.res.setHeader("location",t.url),t.body)return sendStream(e,t.body);e.node.res.end()}const we=new Set(["PATCH","POST","PUT","DELETE"]),Se=new Set(["transfer-encoding","connection","keep-alive","upgrade","expect","host","accept"]);async function proxyRequest(e,t,r={}){let n,s;we.has(e.method)&&(r.streamRequest?(n=function(e){if(!pe.includes(e.method))return;const t=e.web?.request?.body||e._requestBody;return t||(de in e.node.req||"rawBody"in e.node.req||"body"in e.node.req||"__unenv__"in e.node.req?new ReadableStream({async start(t){const r=await readRawBody(e,!1);r&&t.enqueue(r),t.close()}}):new ReadableStream({start:t=>{e.node.req.on("data",(e=>{t.enqueue(e)})),e.node.req.on("end",(()=>{t.close()})),e.node.req.on("error",(e=>{t.error(e)}))}}))}(e),s="half"):n=await readRawBody(e,!1).catch((()=>{})));const i=r.fetchOptions?.method||e.method,o=function(e,...t){const r=t.filter(Boolean);if(0===r.length)return e;const n=new Headers(e);for(const e of r)for(const[t,r]of Object.entries(e))void 0!==r&&n.set(t,r);return n}(getProxyRequestHeaders(e),r.fetchOptions?.headers,r.headers);return async function(e,t,r={}){let n;try{n=await _getFetch(r.fetch)(t,{headers:r.headers,ignoreResponseError:!0,...r.fetchOptions})}catch(e){throw createError({status:502,statusMessage:"Bad Gateway",cause:e})}e.node.res.statusCode=sanitizeStatusCode(n.status,e.node.res.statusCode),e.node.res.statusMessage=sanitizeStatusMessage(n.statusText);const s=[];for(const[t,r]of n.headers.entries())"content-encoding"!==t&&"content-length"!==t&&("set-cookie"!==t?e.node.res.setHeader(t,r):s.push(...splitCookiesString(r)));s.length>0&&e.node.res.setHeader("set-cookie",s.map((e=>(r.cookieDomainRewrite&&(e=rewriteCookieProperty(e,r.cookieDomainRewrite,"domain")),r.cookiePathRewrite&&(e=rewriteCookieProperty(e,r.cookiePathRewrite,"path")),e))));r.onResponse&&await r.onResponse(e,n);if(void 0!==n._data)return n._data;if(e.handled)return;if(!1===r.sendStream){const t=new Uint8Array(await n.arrayBuffer());return e.node.res.end(t)}if(n.body)for await(const t of n.body)e.node.res.write(t);return e.node.res.end()}(e,t,{...r,fetchOptions:{method:i,body:n,duplex:s,...r.fetchOptions,headers:o}})}function getProxyRequestHeaders(e){const t=Object.create(null),r=getRequestHeaders(e);for(const e in r)Se.has(e)||(t[e]=r[e]);return t}function fetchWithEvent(e,t,r,n){return _getFetch(n?.fetch)(t,{...r,context:r?.context||e.context,headers:{...getProxyRequestHeaders(e),...r?.headers}})}function _getFetch(e){if(e)return e;if(globalThis.fetch)return globalThis.fetch;throw new Error("fetch is not available. Try importing `node-fetch-native/polyfill` for Node.js.")}function rewriteCookieProperty(e,t,r){const n="string"==typeof t?{"*":t}:t;return e.replace(new RegExp(`(;\\s*${r}=)([^;]+)`,"gi"),((e,t,r)=>{let s;if(r in n)s=n[r];else{if(!("*"in n))return e;s=n["*"]}return s?t+s:""}))}var ve=Object.defineProperty,__publicField=(e,t,r)=>(((e,t,r)=>{t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class H3Event{constructor(e,t){__publicField(this,"__is_event__",!0),__publicField(this,"node"),__publicField(this,"web"),__publicField(this,"context",{}),__publicField(this,"_method"),__publicField(this,"_path"),__publicField(this,"_headers"),__publicField(this,"_requestBody"),__publicField(this,"_handled",!1),__publicField(this,"_onBeforeResponseCalled"),__publicField(this,"_onAfterResponseCalled"),this.node={req:e,res:t}}get method(){return this._method||(this._method=(this.node.req.method||"GET").toUpperCase()),this._method}get path(){return this._path||this.node.req.url||"/"}get headers(){return this._headers||(this._headers=function(e){const t=new Headers;for(const[r,n]of Object.entries(e))if(Array.isArray(n))for(const e of n)t.append(r,e);else n&&t.set(r,n);return t}(this.node.req.headers)),this._headers}get handled(){return this._handled||this.node.res.writableEnded||this.node.res.headersSent}respondWith(e){return Promise.resolve(e).then((e=>sendWebResponse(this,e)))}toString(){return`[${this.method}] ${this.path}`}toJSON(){return this.toString()}get req(){return this.node.req}get res(){return this.node.res}}function isEvent(e){return hasProp(e,"__is_event__")}function createEvent(e,t){return new H3Event(e,t)}function defineEventHandler(e){if("function"==typeof e)return e.__is_handler__=!0,e;const t={onRequest:_normalizeArray(e.onRequest),onBeforeResponse:_normalizeArray(e.onBeforeResponse)},_handler=r=>async function(e,t,r){if(r.onRequest)for(const t of r.onRequest)if(await t(e),e.handled)return;const n=await t(e),s={body:n};if(r.onBeforeResponse)for(const t of r.onBeforeResponse)await t(e,s);return s.body}(r,e.handler,t);return _handler.__is_handler__=!0,_handler.__resolve__=e.handler.__resolve__,_handler.__websocket__=e.websocket,_handler}function _normalizeArray(e){return e?Array.isArray(e)?e:[e]:void 0}const _e=defineEventHandler;function isEventHandler(e){return hasProp(e,"__is_handler__")}function toEventHandler(e,t,r){return isEventHandler(e)||console.warn("[h3] Implicit event handler conversion is deprecated. Use `eventHandler()` or `fromNodeMiddleware()` to define event handlers.",r&&"/"!==r?`\n     Route: ${r}`:"",`\n     Handler: ${e}`),e}const lazyEventHandler=function(e){let t,r;const resolveHandler=()=>r?Promise.resolve(r):(t||(t=Promise.resolve(e()).then((e=>{const t=e.default||e;if("function"!=typeof t)throw new TypeError("Invalid lazy handler result. It should be a function:",t);return r={handler:toEventHandler(e.default||e)},r}))),t),n=_e((e=>r?r.handler(e):resolveHandler().then((t=>t.handler(e)))));return n.__resolve__=resolveHandler,n};function createApp(e={}){const t=[],r=function(e,t){const r=t.debug?2:void 0;return _e((async n=>{n.node.req.originalUrl=n.node.req.originalUrl||n.node.req.url||"/";const s=n._path||n.node.req.url||"/";let i;t.onRequest&&await t.onRequest(n);for(const o of e){if(o.route.length>1){if(!s.startsWith(o.route))continue;i=s.slice(o.route.length)||"/"}else i=s;if(o.match&&!o.match(i,n))continue;n._path=i,n.node.req.url=i;const e=await o.handler(n),a=void 0===e?void 0:await e;if(void 0!==a){const e={body:a};return t.onBeforeResponse&&(n._onBeforeResponseCalled=!0,await t.onBeforeResponse(n,e)),await handleHandlerResponse(n,e.body,r),void(t.onAfterResponse&&(n._onAfterResponseCalled=!0,await t.onAfterResponse(n,e)))}if(n.handled)return void(t.onAfterResponse&&(n._onAfterResponseCalled=!0,await t.onAfterResponse(n,void 0)))}if(!n.handled)throw createError({statusCode:404,statusMessage:`Cannot find any path matching ${n.path||"/"}.`});t.onAfterResponse&&(n._onAfterResponseCalled=!0,await t.onAfterResponse(n,void 0))}))}(t,e),n=function(e){return async t=>{let r;for(const n of e){if("/"===n.route&&!n.handler.__resolve__)continue;if(!t.startsWith(n.route))continue;if(r=t.slice(n.route.length)||"/",n.match&&!n.match(r,void 0))continue;let e={route:n.route,handler:n.handler};if(e.handler.__resolve__){const t=await e.handler.__resolve__(r);if(!t)continue;e={...e,...t,route:joinURL(e.route||"/",t.route||"/")}}return e}}}(t);r.__resolve__=n;const s=function(e){let t;return()=>(t||(t=e()),t)}((()=>{return t=n,{...e.websocket,async resolve(e){const{pathname:r}=parseURL(e.url||"/"),n=await t(r);return n?.handler?.__websocket__||{}}};var t})),i={use:(e,t,r)=>use(i,e,t,r),resolve:n,handler:r,stack:t,options:e,get websocket(){return s()}};return i}function use(e,t,r,n){if(Array.isArray(t))for(const s of t)use(e,s,r,n);else if(Array.isArray(r))for(const s of r)use(e,t,s,n);else"string"==typeof t?e.stack.push(normalizeLayer({...n,route:t,handler:r})):"function"==typeof t?e.stack.push(normalizeLayer({...r,handler:t})):e.stack.push(normalizeLayer({...t}));return e}function normalizeLayer(e){let t=e.handler;return t.handler&&(t=t.handler),e.lazy?t=lazyEventHandler(t):isEventHandler(t)||(t=toEventHandler(t,0,e.route)),{route:withoutTrailingSlash(e.route),match:e.match,handler:t}}function handleHandlerResponse(e,t,r){if(null===t)return function(e,t){if(e.handled)return;t||200===e.node.res.statusCode||(t=e.node.res.statusCode);const r=sanitizeStatusCode(t,204);204===r&&e.node.res.removeHeader("content-length"),e.node.res.writeHead(r),e.node.res.end()}(e);if(t){if(n=t,"undefined"!=typeof Response&&n instanceof Response)return sendWebResponse(e,t);if(function(e){if(!e||"object"!=typeof e)return!1;if("function"==typeof e.pipe){if("function"==typeof e._read)return!0;if("function"==typeof e.abort)return!0}return"function"==typeof e.pipeTo}(t))return sendStream(e,t);if(t.buffer)return send(e,t);if(t.arrayBuffer&&"function"==typeof t.arrayBuffer)return t.arrayBuffer().then((r=>send(e,c.from(r),t.type)));if(t instanceof Error)throw createError(t);if("function"==typeof t.end)return!0}var n;const s=typeof t;if("string"===s)return send(e,t,me.html);if("object"===s||"boolean"===s||"number"===s)return send(e,JSON.stringify(t,void 0,r),me.json);if("bigint"===s)return send(e,t.toString(),me.json);throw createError({statusCode:500,statusMessage:`[h3] Cannot send ${s} as response.`})}const Be=["connect","delete","get","head","options","post","put","trace","patch"];function toNodeListener(e){return async function(t,r){const n=createEvent(t,r);try{await e.handler(n)}catch(t){const r=createError(t);if(isError(t)||(r.unhandled=!0),setResponseStatus(n,r.statusCode,r.statusMessage),e.options.onError&&await e.options.onError(r,n),n.handled)return;(r.unhandled||r.fatal)&&console.error("[h3]",r.fatal?"[fatal]":"[unhandled]",r),e.options.onBeforeResponse&&!n._onBeforeResponseCalled&&await e.options.onBeforeResponse(n,{body:r}),await function(e,t,r){if(e.handled)return;const n=isError(t)?t:createError(t),s={statusCode:n.statusCode,statusMessage:n.statusMessage,stack:[],data:n.data};if(r&&(s.stack=(n.stack||"").split("\n").map((e=>e.trim()))),e.handled)return;setResponseStatus(e,Number.parseInt(n.statusCode),n.statusMessage),e.node.res.setHeader("content-type",me.json),e.node.res.end(JSON.stringify(s,void 0,2))}(n,r,!!e.options.debug),e.options.onAfterResponse&&!n._onAfterResponseCalled&&await e.options.onAfterResponse(n,{body:r})}}}class FetchError extends Error{constructor(e,t){super(e,t),this.name="FetchError",t?.cause&&!this.cause&&(this.cause=t.cause)}}const Te=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function isPayloadMethod(e="GET"){return Te.has(e.toUpperCase())}const Le=new Set(["image/svg","application/xml","application/xhtml","application/html"]),Re=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function mergeFetchOptions(e,t,r=globalThis.Headers){const n={...t,...e};if(t?.params&&e?.params&&(n.params={...t?.params,...e?.params}),t?.query&&e?.query&&(n.query={...t?.query,...e?.query}),t?.headers&&e?.headers){n.headers=new r(t?.headers||{});for(const[t,s]of new r(e?.headers||{}))n.headers.set(t,s)}return n}const Ee=new Set([408,409,425,429,500,502,503,504]),qe=new Set([101,204,205,304]);function createFetch$1(e={}){const{fetch:t=globalThis.fetch,Headers:r=globalThis.Headers,AbortController:n=globalThis.AbortController}=e;async function onError(e){const t=e.error&&"AbortError"===e.error.name&&!e.options.timeout||!1;if(!1!==e.options.retry&&!t){let t;t="number"==typeof e.options.retry?e.options.retry:isPayloadMethod(e.options.method)?0:1;const r=e.response&&e.response.status||500;if(t>0&&(Array.isArray(e.options.retryStatusCodes)?e.options.retryStatusCodes.includes(r):Ee.has(r))){const r=e.options.retryDelay||0;return r>0&&await new Promise((e=>setTimeout(e,r))),$fetchRaw(e.request,{...e.options,retry:t-1})}}const r=function(e){const t=e.error?.message||e.error?.toString()||"",r=e.request?.method||e.options?.method||"GET",n=e.request?.url||String(e.request)||"/",s=`[${r}] ${JSON.stringify(n)}`,i=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",o=new FetchError(`${s}: ${i}${t?` ${t}`:""}`,e.error?{cause:e.error}:void 0);for(const t of["request","options","response"])Object.defineProperty(o,t,{get:()=>e[t]});for(const[t,r]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(o,t,{get:()=>e.response&&e.response[r]});return o}(e);throw Error.captureStackTrace&&Error.captureStackTrace(r,$fetchRaw),r}const $fetchRaw=async function(s,i={}){const o={request:s,options:mergeFetchOptions(i,e.defaults,r),response:void 0,error:void 0};let a;if(o.options.method=o.options.method?.toUpperCase(),o.options.onRequest&&await o.options.onRequest(o),"string"==typeof o.request&&(o.options.baseURL&&(o.request=function(e,t){if(isEmptyURL(t)||hasProtocol(e))return e;const r=withoutTrailingSlash(t);return e.startsWith(r)?e:joinURL(r,e)}(o.request,o.options.baseURL)),(o.options.query||o.options.params)&&(o.request=withQuery(o.request,{...o.options.params,...o.options.query}))),o.options.body&&isPayloadMethod(o.options.method)&&(!function(e){if(void 0===e)return!1;const t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}(o.options.body)?("pipeTo"in o.options.body&&"function"==typeof o.options.body.pipeTo||"function"==typeof o.options.body.pipe)&&("duplex"in o.options||(o.options.duplex="half")):(o.options.body="string"==typeof o.options.body?o.options.body:JSON.stringify(o.options.body),o.options.headers=new r(o.options.headers||{}),o.options.headers.has("content-type")||o.options.headers.set("content-type","application/json"),o.options.headers.has("accept")||o.options.headers.set("accept","application/json"))),!o.options.signal&&o.options.timeout){const e=new n;a=setTimeout((()=>e.abort()),o.options.timeout),o.options.signal=e.signal}try{o.response=await t(o.request,o.options)}catch(e){return o.error=e,o.options.onRequestError&&await o.options.onRequestError(o),await onError(o)}finally{a&&clearTimeout(a)}if(o.response.body&&!qe.has(o.response.status)&&"HEAD"!==o.options.method){const e=(o.options.parseResponse?"json":o.options.responseType)||function(e=""){if(!e)return"json";const t=e.split(";").shift()||"";return Re.test(t)?"json":Le.has(t)||t.startsWith("text/")?"text":"blob"}(o.response.headers.get("content-type")||"");switch(e){case"json":{const e=await o.response.text(),t=o.options.parseResponse||destr;o.response._data=t(e);break}case"stream":o.response._data=o.response.body;break;default:o.response._data=await o.response[e]()}}return o.options.onResponse&&await o.options.onResponse(o),!o.options.ignoreResponseError&&o.response.status>=400&&o.response.status<600?(o.options.onResponseError&&await o.options.onResponseError(o),await onError(o)):o.response},$fetch=async function(e,t){return(await $fetchRaw(e,t))._data};return $fetch.raw=$fetchRaw,$fetch.native=(...e)=>t(...e),$fetch.create=(t={})=>createFetch$1({...e,defaults:{...e.defaults,...t}}),$fetch}const $e=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}(),xe=$e.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),Ce=$e.Headers,Ae=$e.AbortController,Ne=createFetch$1({fetch:xe,Headers:Ce,AbortController:Ae}),Ie=new Set([101,204,205,304]);function flatHooks(e,t={},r){for(const n in e){const s=e[n],i=r?`${r}:${n}`:n;"object"==typeof s&&null!==s?flatHooks(s,t,i):"function"==typeof s&&(t[i]=s)}return t}const Qe={run:e=>e()},ke=void 0!==console.createTask?console.createTask:()=>Qe;function serialTaskCaller(e,t){const r=t.shift(),n=ke(r);return e.reduce(((e,r)=>e.then((()=>n.run((()=>r(...t)))))),Promise.resolve())}function parallelTaskCaller(e,t){const r=t.shift(),n=ke(r);return Promise.all(e.map((e=>n.run((()=>e(...t))))))}function callEachWith(e,t){for(const r of[...e])r(t)}class Hookable{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(e,t,r={}){if(!e||"function"!=typeof t)return()=>{};const n=e;let s;for(;this._deprecatedHooks[e];)s=this._deprecatedHooks[e],e=s.to;if(s&&!r.allowDeprecated){let e=s.message;e||(e=`${n} hook has been deprecated`+(s.to?`, please use ${s.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(e)||(console.warn(e),this._deprecatedMessages.add(e))}if(!t.name)try{Object.defineProperty(t,"name",{get:()=>"_"+e.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(t),()=>{t&&(this.removeHook(e,t),t=void 0)}}hookOnce(e,t){let r,_function=(...e)=>("function"==typeof r&&r(),r=void 0,_function=void 0,t(...e));return r=this.hook(e,_function),r}removeHook(e,t){if(this._hooks[e]){const r=this._hooks[e].indexOf(t);-1!==r&&this._hooks[e].splice(r,1),0===this._hooks[e].length&&delete this._hooks[e]}}deprecateHook(e,t){this._deprecatedHooks[e]="string"==typeof t?{to:t}:t;const r=this._hooks[e]||[];delete this._hooks[e];for(const t of r)this.hook(e,t)}deprecateHooks(e){Object.assign(this._deprecatedHooks,e);for(const t in e)this.deprecateHook(t,e[t])}addHooks(e){const t=flatHooks(e),r=Object.keys(t).map((e=>this.hook(e,t[e])));return()=>{for(const e of r.splice(0,r.length))e()}}removeHooks(e){const t=flatHooks(e);for(const e in t)this.removeHook(e,t[e])}removeAllHooks(){for(const e in this._hooks)delete this._hooks[e]}callHook(e,...t){return t.unshift(e),this.callHookWith(serialTaskCaller,e,...t)}callHookParallel(e,...t){return t.unshift(e),this.callHookWith(parallelTaskCaller,e,...t)}callHookWith(e,t,...r){const n=this._before||this._after?{name:t,args:r,context:{}}:void 0;this._before&&callEachWith(this._before,n);const s=e(t in this._hooks?[...this._hooks[t]]:[],r);return s instanceof Promise?s.finally((()=>{this._after&&n&&callEachWith(this._after,n)})):(this._after&&n&&callEachWith(this._after,n),s)}beforeEach(e){return this._before=this._before||[],this._before.push(e),()=>{if(void 0!==this._before){const t=this._before.indexOf(e);-1!==t&&this._before.splice(t,1)}}}afterEach(e){return this._after=this._after||[],this._after.push(e),()=>{if(void 0!==this._after){const t=this._after.indexOf(e);-1!==t&&this._after.splice(t,1)}}}}function createHooks(){return new Hookable}function klona(e){if("object"!=typeof e)return e;var t,r,n=Object.prototype.toString.call(e);if("[object Object]"===n){if(e.constructor!==Object&&"function"==typeof e.constructor)for(t in r=new e.constructor,e)e.hasOwnProperty(t)&&r[t]!==e[t]&&(r[t]=klona(e[t]));else for(t in r={},e)"__proto__"===t?Object.defineProperty(r,t,{value:klona(e[t]),configurable:!0,enumerable:!0,writable:!0}):r[t]=klona(e[t]);return r}if("[object Array]"===n){for(t=e.length,r=Array(t);t--;)r[t]=klona(e[t]);return r}return"[object Set]"===n?(r=new Set,e.forEach((function(e){r.add(klona(e))})),r):"[object Map]"===n?(r=new Map,e.forEach((function(e,t){r.set(klona(t),klona(e))})),r):"[object Date]"===n?new Date(+e):"[object RegExp]"===n?((r=new RegExp(e.source,e.flags)).lastIndex=e.lastIndex,r):"[object DataView]"===n?new e.constructor(klona(e.buffer)):"[object ArrayBuffer]"===n?e.slice(0):"Array]"===n.slice(-6)?new e.constructor(e):e}const Oe=/\d/,Pe=["-","_","/","."];function isUppercase(e=""){if(!Oe.test(e))return e!==e.toLowerCase()}function kebabCase(e,t){return e?(Array.isArray(e)?e:function(e){const t=Pe,r=[];if(!e||"string"!=typeof e)return r;let n,s,i="";for(const o of e){const e=t.includes(o);if(!0===e){r.push(i),i="",n=void 0;continue}const a=isUppercase(o);if(!1===s){if(!1===n&&!0===a){r.push(i),i=o,n=a;continue}if(!0===n&&!1===a&&i.length>1){const e=i.at(-1);r.push(i.slice(0,Math.max(0,i.length-1))),i=e+o,n=a;continue}}i+=o,n=a,s=e}return r.push(i),r}(e)).map((e=>e.toLowerCase())).join(t):""}function getEnv(e,t){const r=(n=e,kebabCase(n||"","_")).toUpperCase();var n;return destr(_.env[t.prefix+r]??_.env[t.altPrefix+r])}function _isObject(e){return"object"==typeof e&&!Array.isArray(e)}function applyEnv(e,t,r=""){for(const n in e){const s=r?`${r}_${n}`:n,i=getEnv(s,t);_isObject(e[n])?_isObject(i)?(e[n]={...e[n],...i},applyEnv(e[n],t,s)):void 0===i?applyEnv(e[n],t,s):e[n]=i??e[n]:e[n]=i??e[n],t.envExpansion&&"string"==typeof e[n]&&(e[n]=e[n].replace(je,((e,t)=>_.env[t]||e)))}return e}const je=/{{(.*?)}}/g;const Me=re({nuxt:{}}),Ue={app:{baseURL:"/",buildId:"f573e959-74dd-48ad-bf7f-990c83740521",buildAssetsDir:"/_nuxt/",cdnURL:""},nitro:{envPrefix:"NUXT_",routeRules:{"/__nuxt_error":{cache:!1},"/_nuxt/builds/meta/**":{headers:{"cache-control":"public, max-age=31536000, immutable"}},"/_nuxt/builds/**":{headers:{"cache-control":"public, max-age=1, immutable"}},"/_nuxt/**":{headers:{"cache-control":"public, max-age=31536000, immutable"}}}},public:{}},He={prefix:"NITRO_",altPrefix:Ue.nitro.envPrefix??_.env.NITRO_ENV_PREFIX??"_",envExpansion:Ue.nitro.envExpansion??_.env.NITRO_ENV_EXPANSION??!1},De=_deepFreeze(applyEnv(klona(Ue),He));function useRuntimeConfig(e){if(!e)return De;if(e.context.nitro.runtimeConfig)return e.context.nitro.runtimeConfig;const t=klona(Ue);return applyEnv(t,He),e.context.nitro.runtimeConfig=t,t}function _deepFreeze(e){const t=Object.getOwnPropertyNames(e);for(const r of t){const t=e[r];t&&"object"==typeof t&&_deepFreeze(t)}return Object.freeze(e)}function asyncCall(e,...t){try{return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(e){return Promise.reject(e)}var r}function stringify(e){if(function(e){const t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return stringify(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function checkBufferSupport(){if(void 0===typeof c)throw new TypeError("[unstorage] Buffer is not supported!")}_deepFreeze(klona(Me)),new Proxy(Object.create(null),{get:(e,t)=>{console.warn("Please use `useRuntimeConfig()` instead of accessing config directly.");const r=useRuntimeConfig();if(t in r)return r[t]}});const Fe="base64:";const ze=["hasItem","getItem","getItemRaw","setItem","setItemRaw","removeItem","getMeta","setMeta","removeMeta","getKeys","clear","mount","unmount"];function normalizeKey$1(e){return e?e.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function joinKeys(...e){return normalizeKey$1(e.join(":"))}function normalizeBaseKey(e){return(e=normalizeKey$1(e))?e+":":""}const memory=()=>{const e=new Map;return{name:"memory",options:{},hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>Array.from(e.keys()),clear(){e.clear()},dispose(){e.clear()}}};function watch(e,t,r){return e.watch?e.watch(((e,n)=>t(e,r+n))):()=>{}}async function dispose(e){"function"==typeof e.dispose&&await asyncCall(e.dispose)}const Ke={},normalizeKey=function(e){return e?e.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""},We={getKeys:()=>Promise.resolve(Object.keys(Ke)),hasItem:e=>(e=normalizeKey(e),Promise.resolve(e in Ke)),getItem:e=>(e=normalizeKey(e),Promise.resolve(Ke[e]?Ke[e].import():null)),getMeta:e=>(e=normalizeKey(e),Promise.resolve(Ke[e]?Ke[e].meta:{}))},Ve=function(e={}){const t={mounts:{"":e.driver||memory()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},getMount=e=>{for(const r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},getMounts=(e,r)=>t.mountpoints.filter((t=>t.startsWith(e)||r&&e.startsWith(t))).map((r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]}))),onChange=(e,r)=>{if(t.watching){r=normalizeKey$1(r);for(const n of t.watchListeners)n(e,r)}},stopWatch=async()=>{if(t.watching){for(const e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},runBatch=(e,t,r)=>{const n=new Map,getBatch=e=>{let t=n.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},n.set(e.base,t)),t};for(const r of e){const e="string"==typeof r,n=normalizeKey$1(e?r:r.key),s=e?void 0:r.value,i=e||!r.options?t:{...t,...r.options},o=getMount(n);getBatch(o).items.push({key:n,value:s,relativeKey:o.relativeKey,options:i})}return Promise.all([...n.values()].map((e=>r(e)))).then((e=>e.flat()))},r={hasItem(e,t={}){e=normalizeKey$1(e);const{relativeKey:r,driver:n}=getMount(e);return asyncCall(n.hasItem,r,t)},getItem(e,t={}){e=normalizeKey$1(e);const{relativeKey:r,driver:n}=getMount(e);return asyncCall(n.getItem,r,t).then((e=>destr(e)))},getItems:(e,t)=>runBatch(e,t,(e=>e.driver.getItems?asyncCall(e.driver.getItems,e.items.map((e=>({key:e.relativeKey,options:e.options}))),t).then((t=>t.map((t=>({key:joinKeys(e.base,t.key),value:destr(t.value)}))))):Promise.all(e.items.map((t=>asyncCall(e.driver.getItem,t.relativeKey,t.options).then((e=>({key:t.key,value:destr(e)})))))))),getItemRaw(e,t={}){e=normalizeKey$1(e);const{relativeKey:r,driver:n}=getMount(e);return n.getItemRaw?asyncCall(n.getItemRaw,r,t):asyncCall(n.getItem,r,t).then((e=>function(e){return"string"!=typeof e?e:e.startsWith(Fe)?(checkBufferSupport(),c.from(e.slice(Fe.length),"base64")):e}(e)))},async setItem(e,t,n={}){if(void 0===t)return r.removeItem(e);e=normalizeKey$1(e);const{relativeKey:s,driver:i}=getMount(e);i.setItem&&(await asyncCall(i.setItem,s,stringify(t),n),i.watch||onChange("update",e))},async setItems(e,t){await runBatch(e,t,(async e=>{if(e.driver.setItems)return asyncCall(e.driver.setItems,e.items.map((e=>({key:e.relativeKey,value:stringify(e.value),options:e.options}))),t);e.driver.setItem&&await Promise.all(e.items.map((t=>asyncCall(e.driver.setItem,t.relativeKey,stringify(t.value),t.options))))}))},async setItemRaw(e,t,n={}){if(void 0===t)return r.removeItem(e,n);e=normalizeKey$1(e);const{relativeKey:s,driver:i}=getMount(e);if(i.setItemRaw)await asyncCall(i.setItemRaw,s,t,n);else{if(!i.setItem)return;await asyncCall(i.setItem,s,function(e){if("string"==typeof e)return e;checkBufferSupport();const t=c.from(e).toString("base64");return Fe+t}(t),n)}i.watch||onChange("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t}),e=normalizeKey$1(e);const{relativeKey:r,driver:n}=getMount(e);n.removeItem&&(await asyncCall(n.removeItem,r,t),(t.removeMeta||t.removeMata)&&await asyncCall(n.removeItem,r+"$",t),n.watch||onChange("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t}),e=normalizeKey$1(e);const{relativeKey:r,driver:n}=getMount(e),s=Object.create(null);if(n.getMeta&&Object.assign(s,await asyncCall(n.getMeta,r,t)),!t.nativeOnly){const e=await asyncCall(n.getItem,r+"$",t).then((e=>destr(e)));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(s,e))}return s},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){e=normalizeBaseKey(e);const r=getMounts(e,!0);let n=[];const s=[];for(const e of r){const r=(await asyncCall(e.driver.getKeys,e.relativeBase,t)).map((t=>e.mountpoint+normalizeKey$1(t))).filter((e=>!n.some((t=>e.startsWith(t)))));s.push(...r),n=[e.mountpoint,...n.filter((t=>!t.startsWith(e.mountpoint)))]}return e?s.filter((t=>t.startsWith(e)&&!t.endsWith("$"))):s.filter((e=>!e.endsWith("$")))},async clear(e,t={}){e=normalizeBaseKey(e),await Promise.all(getMounts(e,!1).map((async e=>{if(e.driver.clear)return asyncCall(e.driver.clear,e.relativeBase,t);if(e.driver.removeItem){const r=await e.driver.getKeys(e.relativeBase||"",t);return Promise.all(r.map((r=>e.driver.removeItem(r,t))))}})))},async dispose(){await Promise.all(Object.values(t.mounts).map((e=>dispose(e))))},watch:async e=>(await(async()=>{if(!t.watching){t.watching=!0;for(const e in t.mounts)t.unwatch[e]=await watch(t.mounts[e],onChange,e)}})(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter((t=>t!==e)),0===t.watchListeners.length&&await stopWatch()}),async unwatch(){t.watchListeners=[],await stopWatch()},mount(e,n){if((e=normalizeBaseKey(e))&&t.mounts[e])throw new Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort(((e,t)=>t.length-e.length))),t.mounts[e]=n,t.watching&&Promise.resolve(watch(n,onChange,e)).then((r=>{t.unwatch[e]=r})).catch(console.error),r},async unmount(e,r=!0){(e=normalizeBaseKey(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e](),delete t.unwatch[e]),r&&await dispose(t.mounts[e]),t.mountpoints=t.mountpoints.filter((t=>t!==e)),delete t.mounts[e])},getMount(e=""){e=normalizeKey$1(e)+":";const t=getMount(e);return{driver:t.driver,base:t.base}},getMounts(e="",t={}){e=normalizeKey$1(e);return getMounts(e,t.parents).map((e=>({driver:e.driver,base:e.mountpoint})))}};return r}({});function useStorage(e=""){return e?function(e,t){if(!(t=normalizeBaseKey(t)))return e;const r={...e};for(const n of ze)r[n]=(r="",...s)=>e[n](t+r,...s);return r.getKeys=(r="",...n)=>e.getKeys(t+r,...n).then((e=>e.map((e=>e.slice(t.length))))),r}(Ve,e):Ve}Ve.mount("/assets",We);const Je={name:"_",base:"/cache",swr:!0,maxAge:1};const cachedFunction=function(e,t={}){t={...Je,...t};const r={},n=t.group||"nitro/functions",s=t.name||e.name||"_",i=t.integrity||hash([e,t]),o=t.validate||(e=>void 0!==e.value);return async(...a)=>{if(await(t.shouldBypassCache?.(...a)))return e(...a);const l=await(t.getKey||getKey)(...a),u=await(t.shouldInvalidateCache?.(...a)),c=await async function(e,a,l,u){const c=[t.base,n,s,e+".json"].filter(Boolean).join(":").replace(/:\/$/,":index");let f=await useStorage().getItem(c)||{};if("object"!=typeof f){f={};const e=new Error("Malformed data read from cache.");console.error("[nitro] [cache]",e),useNitroApp().captureError(e,{event:u,tags:["cache"]})}const h=1e3*(t.maxAge??t.maxAge??0);h&&(f.expires=Date.now()+h);const d=l||f.integrity!==i||h&&Date.now()-(f.mtime||0)>h||!1===o(f),p=d?(async()=>{const n=r[e];n||(void 0!==f.value&&(t.staleMaxAge||0)>=0&&!1===t.swr&&(f.value=void 0,f.integrity=void 0,f.mtime=void 0,f.expires=void 0),r[e]=Promise.resolve(a()));try{f.value=await r[e]}catch(t){throw n||delete r[e],t}if(!n&&(f.mtime=Date.now(),f.integrity=i,delete r[e],!1!==o(f))){const e=useStorage().setItem(c,f).catch((e=>{console.error("[nitro] [cache] Cache write error.",e),useNitroApp().captureError(e,{event:u,tags:["cache"]})}));u&&u.waitUntil&&u.waitUntil(e)}})():Promise.resolve();return void 0===f.value?await p:d&&u&&u.waitUntil&&u.waitUntil(p),t.swr&&!1!==o(f)?(p.catch((e=>{console.error("[nitro] [cache] SWR handler error.",e),useNitroApp().captureError(e,{event:u,tags:["cache"]})})),f):p.then((()=>f))}(l,(()=>e(...a)),u,a[0]&&isEvent(a[0])?a[0]:void 0);let f=c.value;return t.transform&&(f=await t.transform(c,...a)||f),f}};function getKey(...e){return e.length>0?hash(e,{}):""}function escapeKey(e){return String(e).replace(/\W/g,"")}function cloneWithProxy(e,t){return new Proxy(e,{get:(e,r,n)=>r in t?t[r]:Reflect.get(e,r,n),set:(e,r,n,s)=>r in t?(t[r]=n,!0):Reflect.set(e,r,n,s)})}const cachedEventHandler=function(e,t=Je){const r=(t.varies||[]).filter(Boolean).map((e=>e.toLowerCase())).sort(),n={...t,getKey:async e=>{const n=await(t.getKey?.(e));if(n)return escapeKey(n);const s=e.node.req.originalUrl||e.node.req.url||e.path;return[`${escapeKey(decodeURI(parseURL(s).pathname)).slice(0,16)||"index"}.${hash(s)}`,...r.map((t=>[t,e.node.req.headers[t]])).map((([e,t])=>`${escapeKey(e)}.${hash(t)}`))].join(":")},validate:e=>!!e.value&&(!(e.value.code>=400)&&(void 0!==e.value.body&&("undefined"!==e.value.headers.etag&&"undefined"!==e.value.headers["last-modified"]))),group:t.group||"nitro/handlers",integrity:t.integrity||hash([e,t])},s=cachedFunction((async s=>{const i={};for(const e of r)i[e]=s.node.req.headers[e];const o=cloneWithProxy(s.node.req,{headers:i}),a={};let l;const u=createEvent(o,cloneWithProxy(s.node.res,{statusCode:200,writableEnded:!1,writableFinished:!1,headersSent:!1,closed:!1,getHeader:e=>a[e],setHeader(e,t){return a[e]=t,this},getHeaderNames:()=>Object.keys(a),hasHeader:e=>e in a,removeHeader(e){delete a[e]},getHeaders:()=>a,end(e,t,r){return"string"==typeof e&&(l=e),"function"==typeof t&&t(),"function"==typeof r&&r(),this},write(e,t,r){return"string"==typeof e&&(l=e),"function"==typeof t&&t(),"function"==typeof r&&r(),this},writeHead(e,t){if(this.statusCode=e,t)for(const e in t)this.setHeader(e,t[e]);return this}}));u.fetch=(e,t)=>fetchWithEvent(u,e,t,{fetch:useNitroApp().localFetch}),u.$fetch=(e,t)=>fetchWithEvent(u,e,t,{fetch:globalThis.$fetch}),u.context=s.context,u.context.cache={options:n};const c=await e(u)||l,f=u.node.res.getHeaders();f.etag=String(f.Etag||f.etag||`W/"${hash(c)}"`),f["last-modified"]=String(f["Last-Modified"]||f["last-modified"]||(new Date).toUTCString());const h=[];t.swr?(t.maxAge&&h.push(`s-maxage=${t.maxAge}`),t.staleMaxAge?h.push(`stale-while-revalidate=${t.staleMaxAge}`):h.push("stale-while-revalidate")):t.maxAge&&h.push(`max-age=${t.maxAge}`),h.length>0&&(f["cache-control"]=h.join(", "));return{code:u.node.res.statusCode,headers:f,body:c}}),n);return defineEventHandler((async r=>{if(t.headersOnly){if(handleCacheHeaders(r,{maxAge:t.maxAge}))return;return e(r)}const n=await s(r);if(r.node.res.headersSent||r.node.res.writableEnded)return n.body;if(!handleCacheHeaders(r,{modifiedTime:new Date(n.headers["last-modified"]),etag:n.headers.etag,maxAge:t.maxAge})){r.node.res.statusCode=n.code;for(const e in n.headers){const t=n.headers[e];"set-cookie"===e?r.node.res.appendHeader(e,splitCookiesString(t)):r.node.res.setHeader(e,t)}return n.body}}))},Ge=toRouteMatcher(createRouter$1({routes:useRuntimeConfig().nitro.routeRules}));function createRouteRulesHandler(e){return _e((t=>{const r=getRouteRules(t);if(r.headers&&be(t,r.headers),r.redirect){let e=r.redirect.to;if(e.endsWith("/**")){let n=t.path;const s=r.redirect._redirectStripBase;s&&(n=withoutBase(n,s)),e=joinURL(e.slice(0,-3),n)}else if(t.path.includes("?")){e=withQuery(e,getQuery$1(t.path))}return function(e,t,r=302){return e.node.res.statusCode=sanitizeStatusCode(r,e.node.res.statusCode),e.node.res.setHeader("location",t),send(e,`<!DOCTYPE html><html><head><meta http-equiv="refresh" content="0; url=${t.replace(/"/g,"%22")}"></head></html>`,me.html)}(t,e,r.redirect.statusCode)}if(r.proxy){let n=r.proxy.to;if(n.endsWith("/**")){let e=t.path;const s=r.proxy._proxyStripBase;s&&(e=withoutBase(e,s)),n=joinURL(n.slice(0,-3),e)}else if(t.path.includes("?")){n=withQuery(n,getQuery$1(t.path))}return proxyRequest(t,n,{fetch:e.localFetch,...r.proxy})}}))}function getRouteRules(e){return e.context._nitro=e.context._nitro||{},e.context._nitro.routeRules||(e.context._nitro.routeRules=getRouteRulesForPath(withoutBase(e.path.split("?")[0],useRuntimeConfig().app.baseURL))),e.context._nitro.routeRules}function getRouteRulesForPath(e){return te({},...Ge.matchAll(e).reverse())}const Ye=[],errorHandler=async function(e,t){const{stack:r,statusCode:n,statusMessage:s,message:i}=function(e){const t="function"==typeof _.cwd?_.cwd():"/",r=(e.stack||"").split("\n").splice(1).filter((e=>e.includes("at "))).map((e=>({text:e.replace(t+"/","./").replace("webpack:/","").replace("file://","").trim(),internal:e.includes("node_modules")&&!e.includes(".cache")||e.includes("internal")||e.includes("new Promise")}))),n=e.statusCode||500,s=e.statusMessage??(404===n?"Not Found":""),i=e.message||e.toString();return{stack:r,statusCode:n,statusMessage:s,message:i}}(e),o={url:t.path,statusCode:n,statusMessage:s,message:i,stack:"",data:e.data};if(e.unhandled||e.fatal){const t=["[nuxt]","[request error]",e.unhandled&&"[unhandled]",e.fatal&&"[fatal]",200!==Number(o.statusCode)&&`[${o.statusCode}]`].filter(Boolean).join(" ");console.error(t,o.message+"\n"+r.map((e=>"  "+e.text)).join("  \n"))}if(t.handled)return;if(setResponseStatus(t,200!==o.statusCode&&o.statusCode||500,o.statusMessage),function(e){if(hasReqHeader(e,"accept","text/html"))return!1;return hasReqHeader(e,"accept","application/json")||hasReqHeader(e,"user-agent","curl/")||hasReqHeader(e,"user-agent","httpie/")||hasReqHeader(e,"sec-fetch-mode","cors")||e.path.startsWith("/api/")||e.path.endsWith(".json")}(t))return setResponseHeader(t,"Content-Type","application/json"),send(t,JSON.stringify(o));const a=getRequestHeaders(t),l=t.path.startsWith("/__nuxt_error")||!!a["x-nuxt-error"]?null:await useNitroApp().localFetch(withQuery(joinURL(useRuntimeConfig(t).app.baseURL,"/__nuxt_error"),o),{headers:{...a,"x-nuxt-error":"true"},redirect:"manual"}).catch((()=>null));if(!l){const{template:e}=await import("./_/error-500.mjs");if(t.handled)return;return setResponseHeader(t,"Content-Type","text/html;charset=UTF-8"),send(t,e(o))}const u=await l.text();if(!t.handled){for(const[e,r]of l.headers.entries())setResponseHeader(t,e,r);return setResponseStatus(t,l.status&&200!==l.status?l.status:void 0,l.statusText),send(t,u)}},Ze=Symbol.for("drizzle:entityKind");function is(e,t){if(!e||"object"!=typeof e)return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,Ze))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=e.constructor;if(r)for(;r;){if(Ze in r&&r[Ze]===t[Ze])return!0;r=Object.getPrototypeOf(r)}return!1}class ConsoleLogWriter{static[Ze]="ConsoleLogWriter";write(e){console.log(e)}}class DefaultLogger{static[Ze]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new ConsoleLogWriter}logQuery(e,t){const r=t.map((e=>{try{return JSON.stringify(e)}catch{return String(e)}})),n=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}}class NoopLogger{static[Ze]="NoopLogger";logQuery(){}}const Xe=Symbol.for("drizzle:Name"),et=Symbol.for("drizzle:Schema"),tt=Symbol.for("drizzle:Columns"),rt=Symbol.for("drizzle:ExtraConfigColumns"),nt=Symbol.for("drizzle:OriginalName"),st=Symbol.for("drizzle:BaseName"),it=Symbol.for("drizzle:IsAlias"),ot=Symbol.for("drizzle:ExtraConfigBuilder"),at=Symbol.for("drizzle:IsDrizzleTable");class Table{static[Ze]="Table";static Symbol={Name:Xe,Schema:et,OriginalName:nt,Columns:tt,ExtraConfigColumns:rt,BaseName:st,IsAlias:it,ExtraConfigBuilder:ot};[Xe];[nt];[et];[tt];[rt];[st];[it]=!1;[at]=!0;[ot]=void 0;constructor(e,t,r){this[Xe]=this[nt]=e,this[et]=t,this[st]=r}}function getTableName(e){return e[Xe]}function getTableUniqueName(e){return`${e[et]??"public"}.${e[Xe]}`}class Column{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[Ze]="Column";name;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}const ut=Symbol.for("drizzle:PgInlineForeignKeys");class PgTable extends Table{static[Ze]="PgTable";static Symbol=Object.assign({},Table.Symbol,{InlineForeignKeys:ut});[ut]=[];[Table.Symbol.ExtraConfigBuilder]=void 0}class PrimaryKeyBuilder{static[Ze]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new PrimaryKey(e,this.columns,this.name)}}class PrimaryKey{constructor(e,t,r){this.table=e,this.columns=t,this.name=r}static[Ze]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[PgTable.Symbol.Name]}_${this.columns.map((e=>e.name)).join("_")}_pk`}}class ColumnBuilder{static[Ze]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}}const ct=Symbol.for("drizzle:isPgEnum");class Subquery{static[Ze]="Subquery";constructor(e,t,r,n=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:n}}}class WithSubquery extends Subquery{static[Ze]="WithSubquery"}const ft={startActiveSpan:(e,t)=>t()},ht=Symbol.for("drizzle:ViewBaseConfig");function isSQLWrapper(e){return null!=e&&"function"==typeof e.getSQL}class StringChunk{static[Ze]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new SQL([this])}}class SQL{constructor(e){this.queryChunks=e}static[Ze]="SQL";decoder=dt;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return ft.startActiveSpan("drizzle.buildSQL",(t=>{const r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r}))}buildQueryFromSourceParams(e,t){const r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{escapeName:n,escapeParam:s,prepareTyping:i,inlineParams:o,paramStartIndex:a}=r;return function(e){const t={sql:"",params:[]};for(const r of e)t.sql+=r.sql,t.params.push(...r.params),r.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}(e.map((e=>{if(is(e,StringChunk))return{sql:e.value.join(""),params:[]};if(is(e,Name))return{sql:n(e.value),params:[]};if(void 0===e)return{sql:"",params:[]};if(Array.isArray(e)){const t=[new StringChunk("(")];for(const[r,n]of e.entries())t.push(n),r<e.length-1&&t.push(new StringChunk(", "));return t.push(new StringChunk(")")),this.buildQueryFromSourceParams(t,r)}if(is(e,SQL))return this.buildQueryFromSourceParams(e.queryChunks,{...r,inlineParams:o||e.shouldInlineParams});if(is(e,Table)){const t=e[Table.Symbol.Schema],r=e[Table.Symbol.Name];return{sql:void 0===t?n(r):n(t)+"."+n(r),params:[]}}if(is(e,Column))return"indexes"===t.invokeSource?{sql:n(e.name),params:[]}:{sql:n(e.table[Table.Symbol.Name])+"."+n(e.name),params:[]};if(is(e,View)){const t=e[ht].schema,r=e[ht].name;return{sql:void 0===t?n(r):n(t)+"."+n(r),params:[]}}if(is(e,Param)){if(is(e.value,Placeholder))return{sql:s(a.value++,e),params:[e],typings:["none"]};const t=null===e.value?null:e.encoder.mapToDriverValue(e.value);if(is(t,SQL))return this.buildQueryFromSourceParams([t],r);if(o)return{sql:this.mapInlineParam(t,r),params:[]};let n=["none"];return i&&(n=[i(e.encoder)]),{sql:s(a.value++,t),params:[t],typings:n}}return is(e,Placeholder)?{sql:s(a.value++,e),params:[e],typings:["none"]}:is(e,SQL.Aliased)&&void 0!==e.fieldAlias?{sql:n(e.fieldAlias),params:[]}:is(e,Subquery)?e._.isWith?{sql:n(e._.alias),params:[]}:this.buildQueryFromSourceParams([new StringChunk("("),e._.sql,new StringChunk(") "),new Name(e._.alias)],r):(l=e)&&"function"==typeof l&&ct in l&&!0===l[ct]?e.schema?{sql:n(e.schema)+"."+n(e.enumName),params:[]}:{sql:n(e.enumName),params:[]}:isSQLWrapper(e)?e.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([e.getSQL()],r):this.buildQueryFromSourceParams([new StringChunk("("),e.getSQL(),new StringChunk(")")],r):o?{sql:this.mapInlineParam(e,r),params:[]}:{sql:s(a.value++,e),params:[e],typings:["none"]};var l})))}mapInlineParam(e,{escapeString:t}){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return e.toString();if("string"==typeof e)return t(e);if("object"==typeof e){const r=e.toString();return t("[object Object]"===r?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return void 0===e?this:new SQL.Aliased(this,e)}mapWith(e){return this.decoder="function"==typeof e?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class Name{constructor(e){this.value=e}static[Ze]="Name";brand;getSQL(){return new SQL([this])}}const dt={mapFromDriverValue:e=>e},pt={mapToDriverValue:e=>e};class Param{constructor(e,t=pt){this.value=e,this.encoder=t}static[Ze]="Param";brand;getSQL(){return new SQL([this])}}function sql(e,...t){const r=[];(t.length>0||e.length>0&&""!==e[0])&&r.push(new StringChunk(e[0]));for(const[n,s]of t.entries())r.push(s,new StringChunk(e[n+1]));return new SQL(r)}var mt;(mt=sql||(sql={})).empty=function(){return new SQL([])},mt.fromList=function(e){return new SQL(e)},mt.raw=function(e){return new SQL([new StringChunk(e)])},mt.join=function(e,t){const r=[];for(const[n,s]of e.entries())n>0&&void 0!==t&&r.push(t),r.push(s);return new SQL(r)},mt.identifier=function(e){return new Name(e)},mt.placeholder=function(e){return new Placeholder(e)},mt.param=function(e,t){return new Param(e,t)},(e=>{class Aliased{constructor(e,t){this.sql=e,this.fieldAlias=t}static[Ze]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new Aliased(this.sql,this.fieldAlias)}}e.Aliased=Aliased})(SQL||(SQL={}));class Placeholder{constructor(e){this.name=e}static[Ze]="Placeholder";getSQL(){return new SQL([this])}}function fillPlaceholders(e,t){return e.map((e=>{if(is(e,Placeholder)){if(!(e.name in t))throw new Error(`No value for placeholder "${e.name}" was provided`);return t[e.name]}if(is(e,Param)&&is(e.value,Placeholder)){if(!(e.value.name in t))throw new Error(`No value for placeholder "${e.value.name}" was provided`);return e.encoder.mapToDriverValue(t[e.value.name])}return e}))}class View{static[Ze]="View";[ht];constructor({name:e,schema:t,selectedFields:r,query:n}){this[ht]={name:e,originalName:e,schema:t,selectedFields:r,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new SQL([this])}}function bindIfParam(e,t){return!function(e){return"object"==typeof e&&null!==e&&"mapToDriverValue"in e&&"function"==typeof e.mapToDriverValue}(t)||isSQLWrapper(e)||is(e,Param)||is(e,Placeholder)||is(e,Column)||is(e,Table)||is(e,View)?e:new Param(e,t)}Column.prototype.getSQL=function(){return new SQL([this])},Table.prototype.getSQL=function(){return new SQL([this])},Subquery.prototype.getSQL=function(){return new SQL([this])};const eq=(e,t)=>sql`${e} = ${bindIfParam(t,e)}`,ne=(e,t)=>sql`${e} <> ${bindIfParam(t,e)}`;function and(...e){const t=e.filter((e=>void 0!==e));if(0!==t.length)return 1===t.length?new SQL(t):new SQL([new StringChunk("("),sql.join(t,new StringChunk(" and ")),new StringChunk(")")])}function or(...e){const t=e.filter((e=>void 0!==e));if(0!==t.length)return 1===t.length?new SQL(t):new SQL([new StringChunk("("),sql.join(t,new StringChunk(" or ")),new StringChunk(")")])}function not(e){return sql`not ${e}`}const gt=(e,t)=>sql`${e} > ${bindIfParam(t,e)}`,gte=(e,t)=>sql`${e} >= ${bindIfParam(t,e)}`,lt=(e,t)=>sql`${e} < ${bindIfParam(t,e)}`,lte=(e,t)=>sql`${e} <= ${bindIfParam(t,e)}`;function inArray(e,t){return Array.isArray(t)?0===t.length?sql`false`:sql`${e} in ${t.map((t=>bindIfParam(t,e)))}`:sql`${e} in ${bindIfParam(t,e)}`}function notInArray(e,t){return Array.isArray(t)?0===t.length?sql`true`:sql`${e} not in ${t.map((t=>bindIfParam(t,e)))}`:sql`${e} not in ${bindIfParam(t,e)}`}function isNull(e){return sql`${e} is null`}function isNotNull(e){return sql`${e} is not null`}function exists(e){return sql`exists ${e}`}function notExists(e){return sql`not exists ${e}`}function between(e,t,r){return sql`${e} between ${bindIfParam(t,e)} and ${bindIfParam(r,e)}`}function notBetween(e,t,r){return sql`${e} not between ${bindIfParam(t,e)} and ${bindIfParam(r,e)}`}function like(e,t){return sql`${e} like ${t}`}function notLike(e,t){return sql`${e} not like ${t}`}function ilike(e,t){return sql`${e} ilike ${t}`}function notIlike(e,t){return sql`${e} not ilike ${t}`}function asc(e){return sql`${e} asc`}function desc(e){return sql`${e} desc`}class Relation{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[Table.Symbol.Name]}static[Ze]="Relation";referencedTableName;fieldName}class Relations{constructor(e,t){this.table=e,this.config=t}static[Ze]="Relations"}class One extends Relation{constructor(e,t,r,n){super(e,t,r?.relationName),this.config=r,this.isNullable=n}static[Ze]="One";withFieldName(e){const t=new One(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}}class Many extends Relation{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}static[Ze]="Many";withFieldName(e){const t=new Many(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}function createOne(e){return function(t,r){return new One(e,t,r,r?.fields.reduce(((e,t)=>e&&t.notNull),!0)??!1)}}function createMany(e){return function(t,r){return new Many(e,t,r)}}function normalizeRelation(e,t,r){if(is(r,One)&&r.config)return{fields:r.config.fields,references:r.config.references};const n=t[getTableUniqueName(r.referencedTable)];if(!n)throw new Error(`Table "${r.referencedTable[Table.Symbol.Name]}" not found in schema`);const s=e[n];if(!s)throw new Error(`Table "${n}" not found in schema`);const i=r.sourceTable,o=t[getTableUniqueName(i)];if(!o)throw new Error(`Table "${i[Table.Symbol.Name]}" not found in schema`);const a=[];for(const e of Object.values(s.relations))(r.relationName&&r!==e&&e.relationName===r.relationName||!r.relationName&&e.referencedTable===r.sourceTable)&&a.push(e);if(a.length>1)throw r.relationName?new Error(`There are multiple relations with name "${r.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${r.sourceTable[Table.Symbol.Name]}". Please specify relation name`);if(a[0]&&is(a[0],One)&&a[0].config)return{fields:a[0].config.references,references:a[0].config.fields};throw new Error(`There is not enough information to infer relation "${o}.${r.fieldName}"`)}function createTableRelationsHelpers(e){return{one:createOne(e),many:createMany(e)}}function mapRelationalRow(e,t,r,n,s=e=>e){const i={};for(const[o,a]of n.entries())if(a.isJson){const n=t.relations[a.tsKey],l=r[o],u="string"==typeof l?JSON.parse(l):l;i[a.tsKey]=is(n,One)?u&&mapRelationalRow(e,e[a.relationTableTsKey],u,a.selection,s):u.map((t=>mapRelationalRow(e,e[a.relationTableTsKey],t,a.selection,s)))}else{const e=s(r[o]),t=a.field;let n;n=is(t,Column)?t:is(t,SQL)?t.decoder:t.sql.decoder,i[a.tsKey]=null===e?null:n.mapFromDriverValue(e)}return i}class ColumnAliasProxyHandler{constructor(e){this.table=e}static[Ze]="ColumnAliasProxyHandler";get(e,t){return"table"===t?this.table:e[t]}}class TableAliasProxyHandler{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[Ze]="TableAliasProxyHandler";get(e,t){if(t===Table.Symbol.IsAlias)return!0;if(t===Table.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===Table.Symbol.OriginalName)return this.alias;if(t===ht)return{...e[ht],name:this.alias,isAlias:!0};if(t===Table.Symbol.Columns){const t=e[Table.Symbol.Columns];if(!t)return t;const r={};return Object.keys(t).map((n=>{r[n]=new Proxy(t[n],new ColumnAliasProxyHandler(new Proxy(e,this)))})),r}const r=e[t];return is(r,Column)?new Proxy(r,new ColumnAliasProxyHandler(new Proxy(e,this))):r}}function aliasedTable(e,t){return new Proxy(e,new TableAliasProxyHandler(t,!1))}function aliasedTableColumn(e,t){return new Proxy(e,new ColumnAliasProxyHandler(new Proxy(e.table,new TableAliasProxyHandler(t,!1))))}function mapColumnsInAliasedSQLToAlias(e,t){return new SQL.Aliased(mapColumnsInSQLToAlias(e.sql,t),e.fieldAlias)}function mapColumnsInSQLToAlias(e,t){return sql.join(e.queryChunks.map((e=>is(e,Column)?aliasedTableColumn(e,t):is(e,SQL)?mapColumnsInSQLToAlias(e,t):is(e,SQL.Aliased)?mapColumnsInAliasedSQLToAlias(e,t):e)))}class SelectionProxyHandler{static[Ze]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if("_"===t)return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===ht)return{...e[ht],selectedFields:new Proxy(e[ht].selectedFields,this)};if("symbol"==typeof t)return e[t];const r=(is(e,Subquery)?e._.selectedFields:is(e,View)?e[ht].selectedFields:e)[t];if(is(r,SQL.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!r.isSelectionField)return r.sql;const e=r.clone();return e.isSelectionField=!0,e}if(is(r,SQL)){if("sql"===this.config.sqlBehavior)return r;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return is(r,Column)?this.config.alias?new Proxy(r,new ColumnAliasProxyHandler(new Proxy(r.table,new TableAliasProxyHandler(this.config.alias,this.config.replaceOriginalName??!1)))):r:"object"!=typeof r||null===r?r:new Proxy(r,new SelectionProxyHandler(this.config))}}class QueryPromise{static[Ze]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then((t=>(e?.(),t)),(t=>{throw e?.(),t}))}then(e,t){return this.execute().then(e,t)}}const yt=Symbol.for("drizzle:SQLiteInlineForeignKeys");class SQLiteTable extends Table{static[Ze]="SQLiteTable";static Symbol=Object.assign({},Table.Symbol,{InlineForeignKeys:yt});[Table.Symbol.Columns];[yt]=[];[Table.Symbol.ExtraConfigBuilder]=void 0}const sqliteTable=(e,t,r)=>function(e,t,r,n,s=e){const i=new SQLiteTable(e,n,s),o=Object.fromEntries(Object.entries(t).map((([e,t])=>{const r=t,n=r.build(i);return i[yt].push(...r.buildForeignKeys(n,i)),[e,n]}))),a=Object.assign(i,o);return a[Table.Symbol.Columns]=o,a[Table.Symbol.ExtraConfigColumns]=o,a}(e,t);function mapResultRow(e,t,r){const n={},s=e.reduce(((e,{path:s,field:i},o)=>{let a;a=is(i,Column)?i:is(i,SQL)?i.decoder:i.sql.decoder;let l=e;for(const[e,u]of s.entries())if(e<s.length-1)u in l||(l[u]={}),l=l[u];else{const e=t[o],c=l[u]=null===e?null:a.mapFromDriverValue(e);if(r&&is(i,Column)&&2===s.length){const e=s[0];e in n?"string"==typeof n[e]&&n[e]!==getTableName(i.table)&&(n[e]=!1):n[e]=null===c&&getTableName(i.table)}}return e}),{});if(r&&Object.keys(n).length>0)for(const[e,t]of Object.entries(n))"string"!=typeof t||r[t]||(s[e]=null);return s}function orderSelectedFields(e,t){return Object.entries(e).reduce(((e,[r,n])=>{if("string"!=typeof r)return e;const s=t?[...t,r]:[r];return is(n,Column)||is(n,SQL)||is(n,SQL.Aliased)?e.push({path:s,field:n}):is(n,Table)?e.push(...orderSelectedFields(n[Table.Symbol.Columns],s)):e.push(...orderSelectedFields(n,s)),e}),[])}function haveSameKeys(e,t){const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const[e,t]of r.entries())if(t!==n[e])return!1;return!0}function mapUpdateSet(e,t){const r=Object.entries(t).filter((([,e])=>void 0!==e)).map((([t,r])=>is(r,SQL)?[t,r]:[t,new Param(r,e[Table.Symbol.Columns][t])]));if(0===r.length)throw new Error("No values to set");return Object.fromEntries(r)}function getTableLikeName(e){return is(e,Subquery)?e._.alias:is(e,View)?e[ht].name:is(e,SQL)?void 0:e[Table.Symbol.IsAlias]?e[Table.Symbol.Name]:e[Table.Symbol.BaseName]}class SQLiteDeleteBase extends QueryPromise{constructor(e,t,r,n){super(),this.table=e,this.session=t,this.dialect=r,this.config={table:e,withList:n}}static[Ze]="SQLiteDelete";config;where(e){return this.config.where=e,this}returning(e=this.table[SQLiteTable.Symbol.Columns]){return this.config.returning=orderSelectedFields(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0)}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(e){return this._prepare().execute(e)}$dynamic(){return this}}class SQLiteInsertBuilder{constructor(e,t,r,n){this.table=e,this.session=t,this.dialect=r,this.withList=n}static[Ze]="SQLiteInsertBuilder";values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw new Error("values() must be called with at least one value");const t=e.map((e=>{const t={},r=this.table[Table.Symbol.Columns];for(const n of Object.keys(e)){const s=e[n];t[n]=is(s,SQL)?s:new Param(s,r[n])}return t}));return new SQLiteInsertBase(this.table,t,this.session,this.dialect,this.withList)}}class SQLiteInsertBase extends QueryPromise{constructor(e,t,r,n,s){super(),this.session=r,this.dialect=n,this.config={table:e,values:t,withList:s}}static[Ze]="SQLiteInsert";config;returning(e=this.config.table[SQLiteTable.Symbol.Columns]){return this.config.returning=orderSelectedFields(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=sql`do nothing`;else{const t=Array.isArray(e.target)?sql`${e.target}`:sql`${[e.target]}`,r=e.where?sql` where ${e.where}`:sql``;this.config.onConflict=sql`${t} do nothing${r}`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');const t=e.where?sql` where ${e.where}`:void 0,r=e.targetWhere?sql` where ${e.targetWhere}`:void 0,n=e.setWhere?sql` where ${e.setWhere}`:void 0,s=Array.isArray(e.target)?sql`${e.target}`:sql`${[e.target]}`,i=this.dialect.buildUpdateSet(this.config.table,mapUpdateSet(this.config.table,e.set));return this.config.onConflict=sql`${s}${r} do update set ${i}${t}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0)}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class DrizzleError extends Error{static[Ze]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}}class TransactionRollbackError extends DrizzleError{static[Ze]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}class ForeignKeyBuilder{static[Ze]="SQLiteForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(e,t){this.reference=()=>{const{name:t,columns:r,foreignColumns:n}=e();return{name:t,columns:r,foreignTable:n[0].table,foreignColumns:n}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e,this}onDelete(e){return this._onDelete=e,this}build(e){return new ForeignKey(e,this)}}class ForeignKey{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[Ze]="SQLiteForeignKey";reference;onUpdate;onDelete;getName(){const{name:e,columns:t,foreignColumns:r}=this.reference(),n=t.map((e=>e.name)),s=r.map((e=>e.name)),i=[this.table[SQLiteTable.Symbol.Name],...n,r[0].table[SQLiteTable.Symbol.Name],...s];return e??`${i.join("_")}_fk`}}class SQLiteColumnBuilder extends ColumnBuilder{static[Ze]="SQLiteColumnBuilder";foreignKeyConfigs=[];references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e){return this.config.isUnique=!0,this.config.uniqueName=e,this}generatedAlwaysAs(e,t){return this.config.generated={as:e,type:"always",mode:t?.mode??"virtual"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map((({ref:r,actions:n})=>((r,n)=>{const s=new ForeignKeyBuilder((()=>{const t=r();return{columns:[e],foreignColumns:[t]}}));return n.onUpdate&&s.onUpdate(n.onUpdate),n.onDelete&&s.onDelete(n.onDelete),s.build(t)})(r,n)))}}class SQLiteColumn extends Column{constructor(e,t){t.uniqueName||(t.uniqueName=function(e,t){return`${e[SQLiteTable.Symbol.Name]}_${t.join("_")}_unique`}(e,[t.name])),super(e,t),this.table=e}static[Ze]="SQLiteColumn"}class SQLiteViewBase extends View{static[Ze]="SQLiteViewBase"}class SQLiteDialect{static[Ze]="SQLiteDialect";escapeName(e){return`"${e}"`}escapeParam(e){return"?"}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;const t=[sql`with `];for(const[r,n]of e.entries())t.push(sql`${sql.identifier(n._.alias)} as (${n._.sql})`),r<e.length-1&&t.push(sql`, `);return t.push(sql` `),sql.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:n}){return sql`${this.buildWithCTE(n)}delete from ${e}${t?sql` where ${t}`:void 0}${r?sql` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0}`}buildUpdateSet(e,t){const r=e[Table.Symbol.Columns],n=Object.keys(r).filter((e=>void 0!==t[e]||void 0!==r[e]?.onUpdateFn)),s=n.length;return sql.join(n.flatMap(((e,n)=>{const i=r[e],o=t[e]??sql.param(i.onUpdateFn(),i),a=sql`${sql.identifier(i.name)} = ${o}`;return n<s-1?[a,sql.raw(", ")]:[a]})))}buildUpdateQuery({table:e,set:t,where:r,returning:n,withList:s}){return sql`${this.buildWithCTE(s)}update ${e} set ${this.buildUpdateSet(e,t)}${r?sql` where ${r}`:void 0}${n?sql` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0}`}buildSelection(e,{isSingleTable:t=!1}={}){const r=e.length,n=e.flatMap((({field:e},n)=>{const s=[];if(is(e,SQL.Aliased)&&e.isSelectionField)s.push(sql.identifier(e.fieldAlias));else if(is(e,SQL.Aliased)||is(e,SQL)){const r=is(e,SQL.Aliased)?e.sql:e;t?s.push(new SQL(r.queryChunks.map((e=>is(e,Column)?sql.identifier(e.name):e)))):s.push(r),is(e,SQL.Aliased)&&s.push(sql` as ${sql.identifier(e.fieldAlias)}`)}else if(is(e,Column)){const r=e.table[Table.Symbol.Name],n=e.name;t?s.push(sql.identifier(n)):s.push(sql`${sql.identifier(r)}.${sql.identifier(n)}`)}return n<r-1&&s.push(sql`, `),s}));return sql.join(n)}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:n,having:s,table:i,joins:o,orderBy:a,groupBy:l,limit:u,offset:c,distinct:f,setOperators:h}){const d=r??orderSelectedFields(t);for(const e of d)if(is(e.field,Column)&&getTableName(e.field.table)!==(is(i,Subquery)?i._.alias:is(i,SQLiteViewBase)?i[ht].name:is(i,SQL)?void 0:getTableName(i))&&!(e=>o?.some((({alias:t})=>t===(e[Table.Symbol.IsAlias]?getTableName(e):e[Table.Symbol.BaseName]))))(e.field.table)){const t=getTableName(e.field.table);throw new Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}const p=!o||0===o.length,m=this.buildWithCTE(e),y=f?sql` distinct`:void 0,g=this.buildSelection(d,{isSingleTable:p}),b=is(i,Table)&&i[Table.Symbol.OriginalName]!==i[Table.Symbol.Name]?sql`${sql.identifier(i[Table.Symbol.OriginalName])} ${sql.identifier(i[Table.Symbol.Name])}`:i,w=[];if(o)for(const[e,t]of o.entries()){0===e&&w.push(sql` `);const r=t.table;if(is(r,SQLiteTable)){const e=r[SQLiteTable.Symbol.Name],n=r[SQLiteTable.Symbol.Schema],s=r[SQLiteTable.Symbol.OriginalName],i=e===s?void 0:t.alias;w.push(sql`${sql.raw(t.joinType)} join ${n?sql`${sql.identifier(n)}.`:void 0}${sql.identifier(s)}${i&&sql` ${sql.identifier(i)}`} on ${t.on}`)}else w.push(sql`${sql.raw(t.joinType)} join ${r} on ${t.on}`);e<o.length-1&&w.push(sql` `)}const S=sql.join(w),v=n?sql` where ${n}`:void 0,_=s?sql` having ${s}`:void 0,B=[];if(a)for(const[e,t]of a.entries())B.push(t),e<a.length-1&&B.push(sql`, `);const T=[];if(l)for(const[e,t]of l.entries())T.push(t),e<l.length-1&&T.push(sql`, `);const L=T.length>0?sql` group by ${sql.join(T)}`:void 0,R=B.length>0?sql` order by ${sql.join(B)}`:void 0,q=sql`${m}select${y} ${g} from ${b}${S}${v}${L}${_}${R}${"object"==typeof u||"number"==typeof u&&u>=0?sql` limit ${u}`:void 0}${c?sql` offset ${c}`:void 0}`;return h.length>0?this.buildSetOperations(q,h):q}buildSetOperations(e,t){const[r,...n]=t;if(!r)throw new Error("Cannot pass undefined values to any set operator");return 0===n.length?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:n,limit:s,orderBy:i,offset:o}}){const a=sql`${e.getSQL()} `,l=sql`${n.getSQL()}`;let u;if(i&&i.length>0){const e=[];for(const t of i)if(is(t,SQLiteColumn))e.push(sql.identifier(t.name));else if(is(t,SQL)){for(let e=0;e<t.queryChunks.length;e++){const r=t.queryChunks[e];is(r,SQLiteColumn)&&(t.queryChunks[e]=sql.identifier(r.name))}e.push(sql`${t}`)}else e.push(sql`${t}`);u=sql` order by ${sql.join(e,sql`, `)}`}const c="object"==typeof s||"number"==typeof s&&s>=0?sql` limit ${s}`:void 0,f=sql.raw(`${t} ${r?"all ":""}`);return sql`${a}${f}${l}${u}${c}${o?sql` offset ${o}`:void 0}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:n,withList:s}){const i=[],o=e[Table.Symbol.Columns],a=Object.entries(o).filter((([e,t])=>!t.shouldDisableInsert())),l=a.map((([,e])=>sql.identifier(e.name)));for(const[e,r]of t.entries()){const n=[];for(const[e,t]of a){const s=r[e];if(void 0===s||is(s,Param)&&void 0===s.value){let e;if(null!==t.default&&void 0!==t.default)e=is(t.default,SQL)?t.default:sql.param(t.default,t);else if(void 0!==t.defaultFn){const r=t.defaultFn();e=is(r,SQL)?r:sql.param(r,t)}else if(t.default||void 0===t.onUpdateFn)e=sql`null`;else{const r=t.onUpdateFn();e=is(r,SQL)?r:sql.param(r,t)}n.push(e)}else n.push(s)}i.push(n),e<t.length-1&&i.push(sql`, `)}const u=this.buildWithCTE(s),c=sql.join(i);return sql`${u}insert into ${e} ${l} values ${c}${r?sql` on conflict ${r}`:void 0}${n?sql` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0}`}sqlToQuery(e,t){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:t})}buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:r,table:n,tableConfig:s,queryConfig:i,tableAlias:o,nestedQueryRelation:a,joinOn:l}){let u,c,f,h=[],d=[];const p=[];if(!0===i){h=Object.entries(s.columns).map((([e,t])=>({dbKey:t.name,tsKey:e,field:aliasedTableColumn(t,o),relationTableTsKey:void 0,isJson:!1,selection:[]})))}else{const n=Object.fromEntries(Object.entries(s.columns).map((([e,t])=>[e,aliasedTableColumn(t,o)])));if(i.where){const e="function"==typeof i.where?i.where(n,{and:and,between:between,eq:eq,exists:exists,gt:gt,gte:gte,ilike:ilike,inArray:inArray,isNull:isNull,isNotNull:isNotNull,like:like,lt:lt,lte:lte,ne:ne,not:not,notBetween:notBetween,notExists:notExists,notLike:notLike,notIlike:notIlike,notInArray:notInArray,or:or,sql:sql}):i.where;f=e&&mapColumnsInSQLToAlias(e,o)}const a=[];let l=[];if(i.columns){let e=!1;for(const[t,r]of Object.entries(i.columns))void 0!==r&&t in s.columns&&(e||!0!==r||(e=!0),l.push(t));l.length>0&&(l=e?l.filter((e=>!0===i.columns?.[e])):Object.keys(s.columns).filter((e=>!l.includes(e))))}else l=Object.keys(s.columns);for(const e of l){const t=s.columns[e];a.push({tsKey:e,value:t})}let p,m=[];if(i.with&&(m=Object.entries(i.with).filter((e=>!!e[1])).map((([e,t])=>({tsKey:e,queryConfig:t,relation:s.relations[e]})))),i.extras){p="function"==typeof i.extras?i.extras(n,{sql:sql}):i.extras;for(const[e,t]of Object.entries(p))a.push({tsKey:e,value:mapColumnsInAliasedSQLToAlias(t,o)})}for(const{tsKey:e,value:t}of a)h.push({dbKey:is(t,SQL.Aliased)?t.fieldAlias:s.columns[e].name,tsKey:e,field:is(t,Column)?aliasedTableColumn(t,o):t,relationTableTsKey:void 0,isJson:!1,selection:[]});let y="function"==typeof i.orderBy?i.orderBy(n,{sql:sql,asc:asc,desc:desc}):i.orderBy??[];Array.isArray(y)||(y=[y]),d=y.map((e=>is(e,Column)?aliasedTableColumn(e,o):mapColumnsInSQLToAlias(e,o))),u=i.limit,c=i.offset;for(const{tsKey:n,queryConfig:s,relation:i}of m){const a=normalizeRelation(t,r,i),l=r[getTableUniqueName(i.referencedTable)],u=`${o}_${n}`,c=and(...a.fields.map(((e,t)=>eq(aliasedTableColumn(a.references[t],u),aliasedTableColumn(e,o))))),f=this.buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:r,table:e[l],tableConfig:t[l],queryConfig:is(i,One)?!0===s?{limit:1}:{...s,limit:1}:s,tableAlias:u,joinOn:c,nestedQueryRelation:i}),d=sql`(${f.sql})`.as(n);h.push({dbKey:n,tsKey:n,field:d,relationTableTsKey:l,isJson:!0,selection:f.selection})}}if(0===h.length)throw new DrizzleError({message:`No fields selected for table "${s.tsName}" ("${o}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});let m;if(f=and(l,f),a){let e=sql`json_array(${sql.join(h.map((({field:e})=>is(e,SQLiteColumn)?sql.identifier(e.name):is(e,SQL.Aliased)?e.sql:e)),sql`, `)})`;is(a,Many)&&(e=sql`coalesce(json_group_array(${e}), json_array())`);const t=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:s.tsName,selection:h}];void 0!==u||void 0!==c||d.length>0?(m=this.buildSelectQuery({table:aliasedTable(n,o),fields:{},fieldsFlat:[{path:[],field:sql.raw("*")}],where:f,limit:u,offset:c,orderBy:d,setOperators:[]}),f=void 0,u=void 0,c=void 0,d=void 0):m=aliasedTable(n,o),m=this.buildSelectQuery({table:is(m,SQLiteTable)?m:new Subquery(m,{},o),fields:{},fieldsFlat:t.map((({field:e})=>({path:[],field:is(e,Column)?aliasedTableColumn(e,o):e}))),joins:p,where:f,limit:u,offset:c,orderBy:d,setOperators:[]})}else m=this.buildSelectQuery({table:aliasedTable(n,o),fields:{},fieldsFlat:h.map((({field:e})=>({path:[],field:is(e,Column)?aliasedTableColumn(e,o):e}))),joins:p,where:f,limit:u,offset:c,orderBy:d,setOperators:[]});return{tableTsKey:s.tsName,sql:m,selection:h}}}class SQLiteSyncDialect extends SQLiteDialect{static[Ze]="SQLiteSyncDialect";migrate(e,t,r){const n=void 0===r||"string"==typeof r?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",s=sql`
			CREATE TABLE IF NOT EXISTS ${sql.identifier(n)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;t.run(s);const i=t.values(sql`SELECT id, hash, created_at FROM ${sql.identifier(n)} ORDER BY created_at DESC LIMIT 1`)[0]??void 0;t.run(sql`BEGIN`);try{for(const r of e)if(!i||Number(i[2])<r.folderMillis){for(const e of r.sql)t.run(sql.raw(e));t.run(sql`INSERT INTO ${sql.identifier(n)} ("hash", "created_at") VALUES(${r.hash}, ${r.folderMillis})`)}t.run(sql`COMMIT`)}catch(e){throw t.run(sql`ROLLBACK`),e}}}class SQLiteAsyncDialect extends SQLiteDialect{static[Ze]="SQLiteAsyncDialect";async migrate(e,t,r){const n=void 0===r||"string"==typeof r?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",s=sql`
			CREATE TABLE IF NOT EXISTS ${sql.identifier(n)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;await t.run(s);const i=(await t.values(sql`SELECT id, hash, created_at FROM ${sql.identifier(n)} ORDER BY created_at DESC LIMIT 1`))[0]??void 0;await t.transaction((async t=>{for(const r of e)if(!i||Number(i[2])<r.folderMillis){for(const e of r.sql)await t.run(sql.raw(e));await t.run(sql`INSERT INTO ${sql.identifier(n)} ("hash", "created_at") VALUES(${r.hash}, ${r.folderMillis})`)}}))}}class TypedQueryBuilder{static[Ze]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class SQLiteSelectBuilder{static[Ze]="SQLiteSelectBuilder";fields;session;dialect;withList;distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,this.withList=e.withList,this.distinct=e.distinct}from(e){const t=!!this.fields;let r;return r=this.fields?this.fields:is(e,Subquery)?Object.fromEntries(Object.keys(e._.selectedFields).map((t=>[t,e[t]]))):is(e,SQLiteViewBase)?e[ht].selectedFields:is(e,SQL)?{}:e[Table.Symbol.Columns],new SQLiteSelectBase({table:e,fields:r,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class SQLiteSelectQueryBuilderBase extends TypedQueryBuilder{static[Ze]="SQLiteSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:r,session:n,dialect:s,withList:i,distinct:o}){super(),this.config={withList:i,table:e,fields:{...t},distinct:o,setOperators:[]},this.isPartialSelect=r,this.session=n,this.dialect=s,this._={selectedFields:t},this.tableName=getTableLikeName(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(e){return(t,r)=>{const n=this.tableName,s=getTableLikeName(t);if("string"==typeof s&&this.config.joins?.some((e=>e.alias===s)))throw new Error(`Alias "${s}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof n&&(this.config.fields={[n]:this.config.fields}),"string"==typeof s&&!is(t,SQL))){const e=is(t,Subquery)?t._.selectedFields:is(t,View)?t[ht].selectedFields:t[Table.Symbol.Columns];this.config.fields[s]=e}if("function"==typeof r&&(r=r(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:t,joinType:e,alias:s}),"string"==typeof s)switch(e){case"left":this.joinsNotNullableMap[s]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map((([e])=>[e,!1]))),this.joinsNotNullableMap[s]=!0;break;case"inner":this.joinsNotNullableMap[s]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map((([e])=>[e,!1]))),this.joinsNotNullableMap[s]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return r=>{const n="function"==typeof r?r(getSQLiteSetOperators()):r;if(!haveSameKeys(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);except=this.createSetOperator("except",!1);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){const t=e[0](new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){const t=e[0](new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else{const t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new Subquery(this.getSQL(),this.config.fields,e),new SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class SQLiteSelectBase extends SQLiteSelectQueryBuilderBase{static[Ze]="SQLiteSelect";_prepare(e=!0){if(!this.session)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");const t=orderSelectedFields(this.config.fields),r=this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),t,"all",!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.all()}}function createSetOperator(e,t){return(r,n,...s)=>{const i=[n,...s].map((r=>({type:e,isAll:t,rightSelect:r})));for(const e of i)if(!haveSameKeys(r.getSelectedFields(),e.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(i)}}!function(e,t){for(const r of t)for(const t of Object.getOwnPropertyNames(r.prototype))"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(r.prototype,t)||Object.create(null))}(SQLiteSelectBase,[QueryPromise]);const getSQLiteSetOperators=()=>({union:bt,unionAll:wt,intersect:St,except:vt}),bt=createSetOperator("union",!1),wt=createSetOperator("union",!0),St=createSetOperator("intersect",!1),vt=createSetOperator("except",!1);class QueryBuilder{static[Ze]="SQLiteQueryBuilder";dialect;$with(e){const t=this;return{as:r=>("function"==typeof r&&(r=r(t)),new Proxy(new WithSubquery(r.getSQL(),r.getSelectedFields(),e,!0),new SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){const t=this;return{select:function(r){return new SQLiteSelectBuilder({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(r){return new SQLiteSelectBuilder({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e,distinct:!0})}}}select(e){return new SQLiteSelectBuilder({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new SQLiteSelectBuilder({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new SQLiteSyncDialect),this.dialect}}class SQLiteUpdateBuilder{constructor(e,t,r,n){this.table=e,this.session=t,this.dialect=r,this.withList=n}static[Ze]="SQLiteUpdateBuilder";set(e){return new SQLiteUpdateBase(this.table,mapUpdateSet(this.table,e),this.session,this.dialect,this.withList)}}class SQLiteUpdateBase extends QueryPromise{constructor(e,t,r,n,s){super(),this.session=r,this.dialect=n,this.config={set:t,table:e,withList:s}}static[Ze]="SQLiteUpdate";config;where(e){return this.config.where=e,this}returning(e=this.config.table[SQLiteTable.Symbol.Columns]){return this.config.returning=orderSelectedFields(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0)}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class RelationalQueryBuilder{constructor(e,t,r,n,s,i,o,a){this.mode=e,this.fullSchema=t,this.schema=r,this.tableNamesMap=n,this.table=s,this.tableConfig=i,this.dialect=o,this.session=a}static[Ze]="SQLiteAsyncRelationalQueryBuilder";findMany(e){return"sync"===this.mode?new SQLiteSyncRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many"):new SQLiteRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return"sync"===this.mode?new SQLiteSyncRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first"):new SQLiteRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class SQLiteRelationalQuery extends QueryPromise{constructor(e,t,r,n,s,i,o,a,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=n,this.tableConfig=s,this.dialect=i,this.session=o,this.config=a,this.mode=l}static[Ze]="SQLiteAsyncRelationalQuery";mode;getSQL(){return this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}).sql}_prepare(e=!1){const{query:t,builtQuery:r}=this._toSQL();return this.session[e?"prepareOneTimeQuery":"prepareQuery"](r,void 0,"first"===this.mode?"get":"all",!0,((e,r)=>{const n=e.map((e=>mapRelationalRow(this.schema,this.tableConfig,e,t.selection,r)));return"first"===this.mode?n[0]:n}))}prepare(){return this._prepare(!1)}_toSQL(){const e=this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName});return{query:e,builtQuery:this.dialect.sqlToQuery(e.sql)}}toSQL(){return this._toSQL().builtQuery}executeRaw(){return"first"===this.mode?this._prepare(!1).get():this._prepare(!1).all()}async execute(){return this.executeRaw()}}class SQLiteSyncRelationalQuery extends SQLiteRelationalQuery{static[Ze]="SQLiteSyncRelationalQuery";sync(){return this.executeRaw()}}class SQLiteRaw extends QueryPromise{constructor(e,t,r,n,s){super(),this.execute=e,this.getSQL=t,this.dialect=n,this.mapBatchResult=s,this.config={action:r}}static[Ze]="SQLiteRaw";config;getQuery(){return{...this.dialect.sqlToQuery(this.getSQL()),method:this.config.action}}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}class BaseSQLiteDatabase{constructor(e,t,r,n){this.resultKind=e,this.dialect=t,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={};const s=this.query;if(this._.schema)for(const[i,o]of Object.entries(this._.schema))s[i]=new RelationalQueryBuilder(e,n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],o,t,r)}static[Ze]="BaseSQLiteDatabase";query;$with(e){return{as:t=>("function"==typeof t&&(t=t(new QueryBuilder)),new Proxy(new WithSubquery(t.getSQL(),t.getSelectedFields(),e,!0),new SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){const t=this;return{select:function(r){return new SQLiteSelectBuilder({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(r){return new SQLiteSelectBuilder({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},update:function(r){return new SQLiteUpdateBuilder(r,t.session,t.dialect,e)},insert:function(r){return new SQLiteInsertBuilder(r,t.session,t.dialect,e)},delete:function(r){return new SQLiteDeleteBase(r,t.session,t.dialect,e)}}}select(e){return new SQLiteSelectBuilder({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new SQLiteSelectBuilder({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(e){return new SQLiteUpdateBuilder(e,this.session,this.dialect)}insert(e){return new SQLiteInsertBuilder(e,this.session,this.dialect)}delete(e){return new SQLiteDeleteBase(e,this.session,this.dialect)}run(e){const t=e.getSQL();return"async"===this.resultKind?new SQLiteRaw((async()=>this.session.run(t)),(()=>t),"run",this.dialect,this.session.extractRawRunValueFromBatchResult.bind(this.session)):this.session.run(t)}all(e){const t=e.getSQL();return"async"===this.resultKind?new SQLiteRaw((async()=>this.session.all(t)),(()=>t),"all",this.dialect,this.session.extractRawAllValueFromBatchResult.bind(this.session)):this.session.all(t)}get(e){const t=e.getSQL();return"async"===this.resultKind?new SQLiteRaw((async()=>this.session.get(t)),(()=>t),"get",this.dialect,this.session.extractRawGetValueFromBatchResult.bind(this.session)):this.session.get(t)}values(e){const t=e.getSQL();return"async"===this.resultKind?new SQLiteRaw((async()=>this.session.values(t)),(()=>t),"values",this.dialect,this.session.extractRawValuesValueFromBatchResult.bind(this.session)):this.session.values(t)}transaction(e,t){return this.session.transaction(e,t)}}class ExecuteResultSync extends QueryPromise{constructor(e){super(),this.resultCb=e}static[Ze]="ExecuteResultSync";async execute(){return this.resultCb()}sync(){return this.resultCb()}}class SQLitePreparedQuery{constructor(e,t,r){this.mode=e,this.executeMethod=t,this.query=r}static[Ze]="PreparedQuery";joinsNotNullableMap;getQuery(){return this.query}mapRunResult(e,t){return e}mapAllResult(e,t){throw new Error("Not implemented")}mapGetResult(e,t){throw new Error("Not implemented")}execute(e){return"async"===this.mode?this[this.executeMethod](e):new ExecuteResultSync((()=>this[this.executeMethod](e)))}mapResult(e,t){switch(this.executeMethod){case"run":return this.mapRunResult(e,t);case"all":return this.mapAllResult(e,t);case"get":return this.mapGetResult(e,t)}}}class SQLiteSession{constructor(e){this.dialect=e}static[Ze]="SQLiteSession";prepareOneTimeQuery(e,t,r,n){return this.prepareQuery(e,t,r,n)}run(e){const t=this.dialect.sqlToQuery(e);try{return this.prepareOneTimeQuery(t,void 0,"run",!1).run()}catch(e){throw new DrizzleError({cause:e,message:`Failed to run the query '${t.sql}'`})}}extractRawRunValueFromBatchResult(e){return e}all(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run",!1).all()}extractRawAllValueFromBatchResult(e){throw new Error("Not implemented")}get(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run",!1).get()}extractRawGetValueFromBatchResult(e){throw new Error("Not implemented")}values(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run",!1).values()}extractRawValuesValueFromBatchResult(e){throw new Error("Not implemented")}}class SQLiteTransaction extends BaseSQLiteDatabase{constructor(e,t,r,n,s=0){super(e,t,r,n),this.schema=n,this.nestedIndex=s}static[Ze]="SQLiteTransaction";rollback(){throw new TransactionRollbackError}}class SQLiteD1Session extends SQLiteSession{constructor(e,t,r,n={}){super(t),this.client=e,this.schema=r,this.options=n,this.logger=n.logger??new NoopLogger}static[Ze]="SQLiteD1Session";logger;prepareQuery(e,t,r,n,s){const i=this.client.prepare(e.sql);return new D1PreparedQuery(i,e,this.logger,t,r,n,s)}async batch(e){const t=[],r=[];for(const n of e){const e=n._prepare(),s=e.getQuery();if(t.push(e),s.params.length>0)r.push(e.stmt.bind(...s.params));else{const t=e.getQuery();r.push(this.client.prepare(t.sql).bind(...t.params))}}return(await this.client.batch(r)).map(((e,r)=>t[r].mapResult(e,!0)))}extractRawAllValueFromBatchResult(e){return e.results}extractRawGetValueFromBatchResult(e){return e.results[0]}extractRawValuesValueFromBatchResult(e){return d1ToRawMapping(e.results)}async transaction(e,t){const r=new D1Transaction("async",this.dialect,this,this.schema);await this.run(sql.raw("begin"+(t?.behavior?" "+t.behavior:"")));try{const t=await e(r);return await this.run(sql`commit`),t}catch(e){throw await this.run(sql`rollback`),e}}}class D1Transaction extends SQLiteTransaction{static[Ze]="D1Transaction";async transaction(e){const t=`sp${this.nestedIndex}`,r=new D1Transaction("async",this.dialect,this.session,this.schema,this.nestedIndex+1);await this.session.run(sql.raw(`savepoint ${t}`));try{const n=await e(r);return await this.session.run(sql.raw(`release savepoint ${t}`)),n}catch(e){throw await this.session.run(sql.raw(`rollback to savepoint ${t}`)),e}}}function d1ToRawMapping(e){const t=[];for(const r of e){const e=Object.keys(r).map((e=>r[e]));t.push(e)}return t}class D1PreparedQuery extends SQLitePreparedQuery{constructor(e,t,r,n,s,i,o){super("async",s,t),this.logger=r,this._isResponseInArrayMode=i,this.customResultMapper=o,this.fields=n,this.stmt=e}static[Ze]="D1PreparedQuery";customResultMapper;fields;stmt;run(e){const t=fillPlaceholders(this.query.params,e??{});return this.logger.logQuery(this.query.sql,t),this.stmt.bind(...t).run()}async all(e){const{fields:t,query:r,logger:n,stmt:s,customResultMapper:i}=this;if(!t&&!i){const t=fillPlaceholders(r.params,e??{});return n.logQuery(r.sql,t),s.bind(...t).all().then((({results:e})=>this.mapAllResult(e)))}const o=await this.values(e);return this.mapAllResult(o)}mapAllResult(e,t){return t&&(e=d1ToRawMapping(e.results)),this.fields||this.customResultMapper?this.customResultMapper?this.customResultMapper(e):e.map((e=>mapResultRow(this.fields,e,this.joinsNotNullableMap))):e}async get(e){const{fields:t,joinsNotNullableMap:r,query:n,logger:s,stmt:i,customResultMapper:o}=this;if(!t&&!o){const t=fillPlaceholders(n.params,e??{});return s.logQuery(n.sql,t),i.bind(...t).all().then((({results:e})=>e[0]))}const a=await this.values(e);if(a[0])return o?o(a):mapResultRow(t,a[0],r)}mapGetResult(e,t){return t&&(e=d1ToRawMapping(e.results)[0]),this.fields||this.customResultMapper?this.customResultMapper?this.customResultMapper([e]):mapResultRow(this.fields,e,this.joinsNotNullableMap):e}values(e){const t=fillPlaceholders(this.query.params,e??{});return this.logger.logQuery(this.query.sql,t),this.stmt.bind(...t).raw()}isResponseInArrayMode(){return this._isResponseInArrayMode}}class DrizzleD1Database extends BaseSQLiteDatabase{static[Ze]="D1Database";async batch(e){return this.session.batch(e)}}function drizzle(e,t={}){const r=new SQLiteAsyncDialect;let n,s;if(!0===t.logger?n=new DefaultLogger:!1!==t.logger&&(n=t.logger),t.schema){const e=function(e,t){1===Object.keys(e).length&&"default"in e&&!is(e.default,Table)&&(e=e.default);const r={},n={},s={};for(const[i,o]of Object.entries(e))if(is(o,Table)){const e=getTableUniqueName(o),t=n[e];r[e]=i,s[i]={tsName:i,dbName:o[Table.Symbol.Name],schema:o[Table.Symbol.Schema],columns:o[Table.Symbol.Columns],relations:t?.relations??{},primaryKey:t?.primaryKey??[]};for(const e of Object.values(o[Table.Symbol.Columns]))e.primary&&s[i].primaryKey.push(e);const a=o[Table.Symbol.ExtraConfigBuilder]?.(o[Table.Symbol.ExtraConfigColumns]);if(a)for(const e of Object.values(a))is(e,PrimaryKeyBuilder)&&s[i].primaryKey.push(...e.columns)}else if(is(o,Relations)){const e=getTableUniqueName(o.table),i=r[e],a=o.config(t(o.table));let l;for(const[t,r]of Object.entries(a))i?s[i].relations[t]=r:(e in n||(n[e]={relations:{},primaryKey:l}),n[e].relations[t]=r)}return{tables:s,tableNamesMap:r}}(t.schema,createTableRelationsHelpers);s={fullSchema:t.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}const i=new SQLiteD1Session(e,r,s,{logger:n});return new DrizzleD1Database("async",r,i,s)}const _lazy_lFs6nj=()=>import("./routes/renderer.mjs").then((function(e){return e.X})),_t=[{route:"",handler:defineEventHandler((async e=>{const{DB:t}=e.context.cloudflare.env;e.context.db=drizzle(t)})),lazy:!1,middleware:!0,method:void 0},{route:"/api/teste",handler:()=>import("./routes/api/teste.get.mjs"),lazy:!0,middleware:!1,method:"get"},{route:"/__nuxt_error",handler:_lazy_lFs6nj,lazy:!0,middleware:!1,method:void 0},{route:"/**",handler:_lazy_lFs6nj,lazy:!0,middleware:!1,method:void 0}];const Bt=function(){const e=useRuntimeConfig(),t=createHooks(),captureError=(e,r={})=>{const n=t.callHookParallel("error",e,r).catch((e=>{console.error("Error while capturing another error",e)}));if(r.event&&isEvent(r.event)){const t=r.event.context.nitro?.errors;t&&t.push({error:e,context:r}),r.event.waitUntil&&r.event.waitUntil(n)}},r=createApp({debug:destr(!1),onError:(e,t)=>(captureError(e,{event:t,tags:["request"]}),errorHandler(e,t)),onRequest:async e=>{await Bt.hooks.callHook("request",e).catch((t=>{captureError(t,{event:e,tags:["request"]})}))},onBeforeResponse:async(e,t)=>{await Bt.hooks.callHook("beforeResponse",e,t).catch((t=>{captureError(t,{event:e,tags:["request","response"]})}))},onAfterResponse:async(e,t)=>{await Bt.hooks.callHook("afterResponse",e,t).catch((t=>{captureError(t,{event:e,tags:["request","response"]})}))}}),n=function(e={}){const t=createRouter$1({}),r={};let n;const s={},addRoute=(e,n,i)=>{let o=r[e];if(o||(r[e]=o={path:e,handlers:{}},t.insert(e,o)),Array.isArray(i))for(const t of i)addRoute(e,n,t);else o.handlers[i]=toEventHandler(n,0,e);return s};s.use=s.add=(e,t,r)=>addRoute(e,t,r||"all");for(const e of Be)s[e]=(t,r)=>s.add(t,r,e);const matchHandler=(e="/",r="get")=>{const s=e.indexOf("?");-1!==s&&(e=e.slice(0,Math.max(0,s)));const i=t.lookup(e);if(!i||!i.handlers)return{error:createError({statusCode:404,name:"Not Found",statusMessage:`Cannot find any route matching ${e||"/"}.`})};let o=i.handlers[r]||i.handlers.all;if(!o){n||(n=toRouteMatcher(t));const s=n.matchAll(e).reverse();for(const e of s){if(e.handlers[r]){o=e.handlers[r],i.handlers[r]=i.handlers[r]||o;break}if(e.handlers.all){o=e.handlers.all,i.handlers.all=i.handlers.all||o;break}}}return o?{matched:i,handler:o}:{error:createError({statusCode:405,name:"Method Not Allowed",statusMessage:`Method ${r} is not allowed on this route.`})}},i=e.preemptive||e.preemtive;return s.handler=_e((e=>{const t=matchHandler(e.path,e.method.toLowerCase());if("error"in t){if(i)throw t.error;return}e.context.matchedRoute=t.matched;const r=t.matched.params||{};return e.context.params=r,Promise.resolve(t.handler(e)).then((e=>void 0===e&&i?null:e))})),s.handler.__resolve__=async e=>{e=withLeadingSlash(e);const t=matchHandler(e);if("error"in t)return;let r={route:t.matched.path,handler:t.handler};if(t.handler.__resolve__){const n=await t.handler.__resolve__(e);if(!n)return;r={...r,...n}}return r},s}({preemptive:!0}),s=(i=toNodeListener(r),function(e){const t=new IncomingMessage,r=new ServerResponse(t);if(t.url=e.url||"/",t.method=e.method||"GET",t.headers={},e.headers){const r="function"==typeof e.headers.entries?e.headers.entries():Object.entries(e.headers);for(const[e,n]of r)n&&(t.headers[e.toLowerCase()]=n)}return t.headers.host=t.headers.host||e.host||"localhost",t.connection.encrypted=t.connection.encrypted||"https"===e.protocol,t.body=e.body||null,t.__unenv__=e.context,i(t,r).then((()=>{let e=r._data;(Ie.has(r.statusCode)||"HEAD"===t.method.toUpperCase())&&(e=null,delete r._headers["content-length"]);const n={body:e,headers:r._headers,status:r.statusCode,statusText:r.statusMessage};return t.destroy(),r.destroy(),n}))});var i;const o=function(e,t=global.fetch){return async function(r,n){const s=r.toString();if(!s.startsWith("/"))return t(s,n);try{const t=await e({url:s,...n});return new Response(t.body,{status:t.status,statusText:t.statusText,headers:Object.fromEntries(Object.entries(t.headers).map((([e,t])=>[e,Array.isArray(t)?t.join(","):String(t)||""])))})}catch(e){return new Response(e.toString(),{status:Number.parseInt(e.statusCode||e.code)||500,statusText:e.statusText})}}}(s,globalThis.fetch),localFetch=(e,t)=>o(e,t).then((e=>function(e){if(!e.headers.has("set-cookie"))return e;return new Response(e.body,{status:e.status,statusText:e.statusText,headers:normalizeCookieHeaders(e.headers)})}(e))),a=createFetch$1({fetch:localFetch,Headers:Ce,defaults:{baseURL:e.app.baseURL}});globalThis.$fetch=a,r.use(createRouteRulesHandler({localFetch:localFetch})),r.use(_e((e=>{e.context.nitro=e.context.nitro||{errors:[]};const t=e.node.req?.__unenv__;t&&Object.assign(e.context,t),e.fetch=(t,r)=>fetchWithEvent(e,t,r,{fetch:localFetch}),e.$fetch=(t,r)=>fetchWithEvent(e,t,r,{fetch:a}),e.waitUntil=r=>{e.context.nitro._waitUntilPromises||(e.context.nitro._waitUntilPromises=[]),e.context.nitro._waitUntilPromises.push(r),t?.waitUntil&&t.waitUntil(r)},e.captureError=(t,r)=>{captureError(t,{event:e,...r})}})));for(const t of _t){let s=t.lazy?lazyEventHandler(t.handler):t.handler;if(t.middleware||!t.route){const n=(e.app.baseURL+(t.route||"/")).replace(/\/+/g,"/");r.use(n,s)}else{const e=getRouteRulesForPath(t.route.replace(/:\w+|\*\*/g,"_"));e.cache&&(s=cachedEventHandler(s,{group:"nitro/routes",...e.cache})),n.use(t.route,s,t.method)}}r.use(e.app.baseURL,n.handler);const l={hooks:t,h3App:r,router:n,localCall:s,localFetch:localFetch,captureError:captureError};for(const e of Ye)try{e(l)}catch(e){throw captureError(e,{tags:["plugin"]}),e}return l}(),useNitroApp=()=>Bt,Tt=/post|put|patch/i;function hasReqHeader(e,t,r){const n=function(e,t){return getRequestHeaders(e)[t.toLowerCase()]}(e,t);return n&&"string"==typeof n&&n.toLowerCase().includes(r)}function joinHeaders(e){return Array.isArray(e)?e.join(", "):String(e)}function normalizeCookieHeader(e=""){return splitCookiesString(joinHeaders(e))}function normalizeCookieHeaders(e){const t=new Headers;for(const[r,n]of e)if("set-cookie"===r)for(const e of normalizeCookieHeader(n))t.append("set-cookie",e);else t.set(r,joinHeaders(n));return t}const Lt={"/favicon.ico":{type:"image/vnd.microsoft.icon",etag:'"10be-n8egyE9tcb7sKGr/pYCaQ4uWqxI"',mtime:"2024-08-09T08:56:21.000Z",size:4286,path:"../favicon.ico"},"/robots.txt":{type:"text/plain; charset=utf-8",etag:'"1-rcg7GeeTSRscbqD9i0bNnzLlkvw"',mtime:"2024-08-09T08:56:21.000Z",size:1,path:"../robots.txt"},"/_nuxt/BMMb5G2W.js":{type:"text/javascript; charset=utf-8",etag:'"689-SwVTJuKm3zMui5th8eWolrULFF8"',mtime:"2024-08-23T13:49:35.320Z",size:1673,path:"../_nuxt/BMMb5G2W.js"},"/_nuxt/ByEZ7LPQ.js":{type:"text/javascript; charset=utf-8",etag:'"180-+EAzf/XF1qkhVExoLXteb4fPK0s"',mtime:"2024-08-23T13:49:35.320Z",size:384,path:"../_nuxt/ByEZ7LPQ.js"},"/_nuxt/DjPKoLJh.js":{type:"text/javascript; charset=utf-8",etag:'"ace-0+gVtVcXskB+sy7QLqTc/K5gK2w"',mtime:"2024-08-23T13:49:35.321Z",size:2766,path:"../_nuxt/DjPKoLJh.js"},"/_nuxt/Dl85k8NN.js":{type:"text/javascript; charset=utf-8",etag:'"25b27-g5OPEACWWgncvAVF2ngEbfmoDLI"',mtime:"2024-08-23T13:49:35.318Z",size:154407,path:"../_nuxt/Dl85k8NN.js"},"/_nuxt/error-404.CjGVuf6H.css":{type:"text/css; charset=utf-8",etag:'"de4-SLOwa5sHvQIi2t5fYZEgfDusMUc"',mtime:"2024-08-23T13:49:35.320Z",size:3556,path:"../_nuxt/error-404.CjGVuf6H.css"},"/_nuxt/error-500.DFBAsgKS.css":{type:"text/css; charset=utf-8",etag:'"75c-I8wgoT19gdl/gPtizNKXfkn+TtQ"',mtime:"2024-08-23T13:49:35.320Z",size:1884,path:"../_nuxt/error-500.DFBAsgKS.css"},"/_nuxt/icMPd1hS.js":{type:"text/javascript; charset=utf-8",etag:'"3301-g9URCocd9Ysz+GQ9pLqQrg1GtgE"',mtime:"2024-08-23T13:49:35.321Z",size:13057,path:"../_nuxt/icMPd1hS.js"},"/_nuxt/usbp9_Hp.js":{type:"text/javascript; charset=utf-8",etag:'"2029-bInpRzUthteDVU1tYPKqkwQkbww"',mtime:"2024-08-23T13:49:35.321Z",size:8233,path:"../_nuxt/usbp9_Hp.js"},"/_nuxt/builds/latest.json":{type:"application/json",etag:'"47-V0k/pJ9aF1T726dqKQwZ7a5MBCM"',mtime:"2024-08-23T13:49:36.803Z",size:71,path:"../_nuxt/builds/latest.json"},"/_nuxt/builds/meta/f573e959-74dd-48ad-bf7f-990c83740521.json":{type:"application/json",etag:'"8b-vQPNZYENNjNQ7z7sdPsPSJ4zwBw"',mtime:"2024-08-23T13:49:36.804Z",size:139,path:"../_nuxt/builds/meta/f573e959-74dd-48ad-bf7f-990c83740521.json"}},Rt={"/_nuxt/builds/meta/":{maxAge:31536e3},"/_nuxt/builds/":{maxAge:1},"/_nuxt/":{maxAge:31536e3}};const Et={async fetch(e,t,r){const n=new URL(e.url);if(t.ASSETS&&function(e=""){if(Lt[e])return!0;for(const t in Rt)if(e.startsWith(t))return!0;return!1}(n.pathname))return t.ASSETS.fetch(e);let s;return function(e){return Tt.test(e.method)}(e)&&(s=c.from(await e.arrayBuffer())),globalThis.__env__=t,Bt.localFetch(n.pathname+n.search,{context:{cf:e.cf,waitUntil:e=>r.waitUntil(e),cloudflare:{request:e,env:t,context:r}},host:n.hostname,protocol:n.protocol,method:e.method,headers:e.headers,body:s})},scheduled(e,t,r){}};export{Ne as $,createRouter$1 as A,te as B,hash as C,parseQuery as D,withTrailingSlash as E,withoutTrailingSlash as F,Et as G,SQLiteColumnBuilder as S,SQLiteColumn as a,sqliteTable as b,_e as c,defineEventHandler as d,Ze as e,setResponseHeader as f,send as g,getResponseStatus as h,setResponseStatus as i,setResponseHeaders as j,useNitroApp as k,createHooks as l,joinRelativeURL as m,getQuery as n,createError as o,getRouteRules as p,getResponseStatusText as q,hasProtocol as r,sql as s,isScriptProtocol as t,useRuntimeConfig as u,joinURL as v,withLeadingSlash as w,withQuery as x,sanitizeStatusCode as y,toRouteMatcher as z};
//# sourceMappingURL=runtime.mjs.map
